\chapter{Non-Markovian Quantum State Diffusion}
\label{chap:nmqsd}
% * lin/nonlin Markovian SSE
% * little History
% * alternatives standard (projection?), pseudomodes
% * relevant/irre



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The Microscopical Model}
\label{sec:nmqsd.model}
% * standard model (why oscillators, why linear coupling?)
% * reservoir/environment
% * initial states
%
% TODO Begin more positive!
% TODO elaborate on why we choose linear coupling
% TODO Nonlinear models?
% TODO initial state; correlation function
% TODO Typical correlation functions for infinite systems; decay rate, etc.
% TODO Why oscillator bath?! Feynman Hibbs p.354 --> all cold baths are equivalent
% TODO This correlation function only T=0, general see Weiss (6.11)
% TODO Correlation function --> fluctuation/dissipation theorem
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Although the first and foremost goal of our work is the description of the system's reduced dynamics, we focus on a full system-environment description at first.
On one hand this serves the purpose to better understand the emergence of the typical phenomena when dealing with open quantum systems and their dependence on the bath.
But more important, starting with a closed quantum system is the only strategy that enables a derivation from first principles, in our case the Schrödinger equation.
A last argument in favor of the microscopic approach, PRODUCT STATES, ENTANGLEMENT, etc. ---we will not dwell on the this any further.\\

As a starting point we consider an environment consisting of a finite number $N$ of uncoupled harmonic oscillators.
%\footnote{We will use "environment", "reservoir" and "bath" interchangeably, altough the later two suggest a large size compared to the system.}
This model has been studied extensively for example in the book of Weiss \cite{We99_dissipative_systems}.
The generalization to an infinite number can be carried out formally along the same lines, replacing sums by infinite series or even integrals; a different approach within our framework is presented later.
The dynamics of both the system and the environment are then described by a unitary time evolution governed by the Hamiltonian
\begin{equation}
  \Htot = \Hsys \otimes \unit  +  \unit \otimes \Henv  +  \Hint,
  \label{eq:nmqsd.Htot}
\end{equation}
where $\Hsys$ and $\Henv$ are the free Hamiltonians of the system and the bath respectively.\footnote{For some models like the damped harmonic oscillator \cite{CaLe83_diss_system} an additional renormalization term arises from the interaction. Nevertheless such a contribution is best attributed to $\Hsys$ since it only acts on the system's Hilbert space.}
The later is a sum over independent harmonic oscillators $\Henv = \sum_\lambda \omega_\lambda \adj{a}_\lambda a_\lambda$ expressed in the ladder operators $a_\lambda$ and $\adj{a}_\lambda$ of the $\lambda$-th mode with frequency $\omega_\lambda$.
Treating a finite number of independent reservoirs poses no further difficulties and therefore is not elaborated in this section.

For the interaction between environment and system we confine ourselves to the case of linear coupling
\begin{equation}
  \Hint = \sum_\lambda \cc{g}_\lambda \, L \otimes \adj{a}_\lambda + g_\lambda \, \adj{L} \otimes a_\lambda.
  \label{eq:nmqsd.Hint}
\end{equation}
Here $L$ denotes the coupling operator in the system's Hilbert space and $g_\lambda \in \Complex$ the coupling strength of the $\lambda$-th mode.
Since in typical examples the coupling of an individual bath mode scales inversely with the environment size \cite{We99_dissipative_systems} the linear coupling in~\ref{eq:nmqsd.Hint} seems reasonable for macroscopic large environments.
%TODO stop repetition in "environment"
But our framework also incorporates small environments---even to the extreme of a single harmonic oscillator---with strong coupling as well.
For such cases the linearity needs to be seen as a further assumption of the model.

Beside the Hamiltonian the choice of initial conditions influences the system's subdynamics as well.
Throughout this work we only consider product initial conditions, where the bath is in the vacuum state with respect to all $a_\lambda$
\begin{equation}
  \ket{\Psi_0} = \ket{\psi_0} \bigotimes\limits_\lambda \ket{0_\lambda}.
  \label{eq:nmqsd.initial_conditions}
\end{equation}
These allow us to treat thermal bath states as we show in \autoref{sec:nmqsd.temperature}.\\

To absorb the free dynamics of the environment in time dependent creation and annihilation operators, we switch to the interaction picture with respect to $\Henv$.
Since the bath operators only obtain an additional phase $\exp[\pm \ii \omega_\lambda t]$, the transformed Hamiltonian from \autoref{eq:nmqsd.Htot} reads\footnote{We refrain from introducing another label to distinguish between time-evolution pictures---in what follows we always work in the interaction picture.}
\begin{equation}
  \Htot(t) = \Hsys \otimes \unit  +  \sum_\lambda \left( \cc{g}_\lambda \exp[\ii \omega_\lambda t] \, L \otimes \adj{a}_\lambda + g_\lambda \exp[-\ii \omega t] \, \adj{L} \otimes a_\lambda \right).
  \label{eq:nmqsd.Htot}
\end{equation}
Our choice of unentangled initial conditions with a thermal bath state ensures that the reduced density operator remains unaffected under the change of time-evolution picture.

%TODO This is just copied!
It is instructive to rewrite the last equation using the operator valued force
\begin{equation}
  B(t)=\sum_\lambda g_\lambda a_\lambda \exp[-\ii\omega_\lambda t].
  \label{eq:nmqsd.force_operator}
\end{equation}
The total Hamiltonian then reads $\Htot(t) = \Hsys \otimes \unit  +  L \otimes \adj{B(t)}  +  \adj{L} \otimes B(t)$.
Already from this equation it can be seen, that the complete action of the environment on the system is encoded in the operators $B(t)$.
%TODO Really?
In \autoref{sub:nmqsd.interpretation.time_osci} we introduce an explicit representation of these force operators and discuss their relation with the classical driving and friction forces.
An important---and within our model the only---characteristic of them is the correlation function
\begin{equation*}
  \alpha(t-s) = \big\langle  (B(t) + \adj{B(t)})(B(s) + \adj{B(s)}) \big\rangle_\rho,
\end{equation*}
where $\langle\cdot\rangle_\rho$ stands for the quantum average over the bath state $\rho$.
For a thermal state at temperature $T$, the correlation function can be calculated analytically \cite{FeHi10_path_integrals}
\begin{equation}
  \alpha_\beta(t - s) = \sum_\lambda  \vert g_\lambda \vert^2  \left( \operatorname{coth} \frac{\beta\omega_\lambda}{2} \, \cos \omega_\lambda (t-s)  -  \ii \sin \omega_\lambda(t-s) \right).
  \label{eq:nmqsd.thermal_correlation_function}
\end{equation}
In the limit of zero temperature and under the natural assumption that $\omega_\lambda > 0$, \Autoref{eq:nmqsd.thermal_correlation_function} goes over to
%TODO Add

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Linear NMSSE}
\label{sec:nmqsd.lin_nmsse}
% * Bargman States, hilbert space valued functions
% * derivation
% * problems, non-locality in noise
% * reduced density operator
% * relative state --> interpretation; but also connection with H_s valued functions
% * zero temperature, importance for calculations
% * quantum trajectory Carmichael
%
% TODO define \HHsys
% TODO Citations for full dynamics
% TODO Short proof for analyticity
% TODO Why we write \cc\zz always?
% TODO Proove of functional chain rule?
% TODO Citations of Strunz papers
% TODO stochastic <-> function are the same thing!
% TODO relation to unravelling
% TODO Good, since arbitary α --> infinite size system
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

The first step toward a solution of the full equations of motion~\ref{eq:???} for a realistic system is a reformulation first proposed by Diósi and Strunz\cite{DiSt97_nmsse}:
Expressing the bath degrees of freedom in the Segal-Bargmann Hilbert space of analytic functions\cite{Ba61_coherent_states,Se???} provides a representation that is well suited for a Monte-Carlo treatment.
To this end we introduce the unnormalized coherent state $\ket{z_\lambda} = \exp(z_\lambda \adj{a}_\lambda)\ket{0_\lambda}$ for each mode.
With the shorthand notation $\ket{\zz} = \bigotimes_\lambda \ket{z_\lambda}$, the resolution of the identity for the environment reads
\begin{equation}
  \unit = \int \frac{\exp[-\abs{\zz}^2]}{\pi^N} \, \ket{\zz}\bra{\zz} \dd^{2N}z,
  \label{eq:nmqsd.identity}
\end{equation}
where the integration measure is given by $\dd^{2N}z = \prod_\lambda \dd\Re z_\lambda \dd\Im z_\lambda$.
Throughout this work we often use the shorthand notation $\mudz = \pi^{-N} \exp(-\abs{\vec z}^2) \dd^{2N}z$, which turns out to be meaningful even for an uncountable number of bath oscillators.
\Autoref{eq:nmqsd.identity} allows us to express the full state in a time-independent environment basis
\begin{equation*}
  \ket{\Psi_t} = \int \ket{\psi_t(\cc\zz)} \otimes \ket{\zz} \mudz.
\end{equation*}
For the following derivation it is important to notice that the Segal-Bargmann transform $\zz \mapsto \psi_t(\cc\zz)$ is an anti-holomorphic, $\HHsys$ valued function.
It is equivalent to any other representation of the full state $\ket{\Psi_t}$.
Although the coherent states are not orthogonal, but rather satisfy $\braket{\vec w}{\vec z} = \exp(\sum_\lambda \cc w_\lambda z_\lambda)$, we can write for the reduced density matrix
%TODO Does this need a prove?
\begin{equation}
  \rho(t) = \Tr{env} \ket{\Psi_t}\bra{\Psi_t}
          = \int \ket{\psi_t(\cc\zz)}\bra{\psi_t(\cc\zz)} \mudz.
  \label{eq:nmqsd.reduced_matrix}
\end{equation}
After fixing the kinematic structure, the next step is to rewrite the dynamics: the representation of the ladder operators follow from the usual rules $\bra\zz \adj{a}_\lambda = \cc z_\lambda \bra\zz$ and $\bra\zz a_\lambda = \partial_{\cc z_\lambda} \bra\zz$\cite{???}.
These expressions give us the complete Schrödinger equation~\ref{eq:???} in the transformed space
\begin{equation}
  \partial_t \psi_t(\cc\zz) = -\ii\Hsys\psi_t(\cc\zz)  -  \ii L \sum_\lambda \cc g_\lambda \exp[-\ii\omega_\lambda t] \cc z_\lambda \, \psi_t(\cc\zz)  -  \ii \adj{L} \sum_\lambda g_\lambda \exp[\ii\omega_\lambda t] \, \frac{\partial \psi_t}{\partial z_\lambda}(\cc\zz).
  \label{eq:nmqsd.hamiltonian_microsopic}
\end{equation}
Introducing an effective driving process similar to \autoref{eq:nmqsd.force_operator}
\begin{equation}
  \ZZ_t(\cc\zz) = - \ii \sum_\lambda \cc g_\lambda \exp[\ii \omega_\lambda t] \cc z_\lambda
  \label{eq:nmqsd.stochastic_process}
\end{equation}
allows us to combine the effect of the first bath-interaction term into a single operator.
%TODO Proof?
A similar conversion works for the second term as well with the help of the functional chain rule $\frac{\partial}{\partial \cc z_\lambda} = \int \frac{\partial \ZZ_s}{\partial\cc z_\lambda} \frac{\delta}{\delta \ZZ_s} \dd s$.
our new equation of motion for the Segal-Bargmann transform reads
\begin{equation}
  \partial_t \psi_t = -\ii\Hsys\psi_t  +  L\ZZ_t\psi_t  -  \adj{L} \int_0^t \alpha(t-s) \frac{\delta \psi_t}{\delta \ZZ_s} \dd s.
  \label{eq:nmqsd.nmsse}
\end{equation}
As we shown in \autoref{sub:nmqsd.interpretation.unitary_view}, the integral boundaries arise due to the vacuum initial conditions~\ref{eq:nmqsd.initial_conditions}.
These render $\psi_0$ independent from the driving process, such that causality can be used to confine the integral domain.\\


Up to now we have always referred to \autoref{eq:nmqsd.nmsse} as a transformed Schrödinger equation in the full Hilbert space of both system and bath.
A different attitude is common as well: \Autoref{eq:nmqsd.reduced_matrix} can be rewritten as $\rho_t = \E[\ket{\psi_t}\bra{\psi_t}]$, where $\E\,\dots$ denotes the average over $\mudz = \pi^{-N} \exp(-\abs{\vec z}^2) \dd^{2N}z$.
Put differently the reduced density matrix $\rho_t$ arises as average over the stochastic pure state projectors $\ket{\psi_t(\zz)}\bra{\psi_t(\zz)}$.
Hence we regard \autoref{eq:nmqsd.nmsse} as a stochastic differential equation for the realisation $\psi_t(\zz)$.
We refer to the later either as system state relative to $\ket{\zz}$ or, in the spirit of the stochastic Schrödinger equations emerging from continuous measurements \cite{Ca93_quantum_optics}, as quantum trajectory.
%TODO Add, why we may write \psi_t(\ZZ)
%TODO Better word then driving process?
In this approach the driving process $\ZZ_t$ is implemented as classical stochastic process.
For now it is defined by its concrete version~\ref{eq:nmqsd.stochastic_process} and the underlying probability measure $\mu$.
Hence we see that it is a complex gaussian process with
\begin{equation}
  %TODO Z_t compared to \ZZ_s looks strange! The subscript is moved.
  \E\,Z_t = 0, \quad \E\,Z_t Z_s =0, \quad\mbox{and}\quad \E\,Z_t \ZZ_s = \alpha(t-s),
  \label{eq:nmqsd.process_properties}
\end{equation}
where $\alpha$ is the zero-temperature correlation function~\ref{eq:???}.
Later on we use these properties to generalize our framework to an environment of infinite size.

% TODO This needs some refinement!
Except in the limit $\alpha(t) \propto \delta(t)$, which is elaborated in the next paragraph, the driving process $\ZZ_t$ shows correlation for different times.
This non-Markovian behavior, which makes a complete understanding of the dynamics highly desirable for application but also considerably harder, shows up in the equation of motion~\ref{eq:nmqsd.nmsse} as well.
The last term contains the functional derivative over the whole timespan and therefore takes the complete history of $\psi_t(\ZZ)$ into account.
In its own right the derivative is just as problematic:
% TODO Good idea to question SSE-approach; maybe only refer to numerics
% TODO Quite long sentence!
% TODO Refer to \cite{GaWi02_real_nmsse}?
Since its computation requires not only the realisation $\ZZ_t$, but in some sense all adjacent ones too, it even seems questionable to regard the NMSSE~\ref{eq:nmqsd.nmsse} as a genuine stochastic differential equation, not speaking of a numerical implementation.

%Both points of view, regarding $\psi_t(\zz)$ as an equivalent description for the complete state and as individual realisations of a random system state, are discussed further in \autoref{sec:nmqsd.interpretation}.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Markov Limit}
\label{sub:nmqsd.markov}
% * markov limit
% * problem with negative energy oscillators
% * relation to lindblad/markovian sse
% * Ito vs Stratonovich

The application of stochastic differential equations in the field of open quantum systems (and quantum optics in particular) has a long tradition \cite{???}.
However most of this work is concerned with Markovian systems, which rely on two physical assumptions:
% TODO Good style?, What does memoryless actually mean?
% TODO Why weak coupling?
\begin{description}
  \item[weak coupling] of the system to the reservoir and
  \item[memoryless environment,] that is the time evolution is completely time-local.
\end{description}
% TODO Too much we.
Although in the next section we introduce an equivalent convolutionless formulation, which disposes the time-nonlocal functional derivative, the NMSSE does not in general satisfy the latter condition due to the driving process.
It is only in the standard Markovian limit $\alpha(t) = \gamma\delta(t)$ we can expect to obtain an equation of motion that describes a reduced time evolution without memory.
A rescaling of the coupling operator $L$ allows us to set $\gamma = 1$ without loss of generality.

% TODO Really?
As shown in \autoref{???} the vacuum initial conditions $\frac{\delta \psi_0}{\delta \ZZ_s} = 0$ for all $s \in \Reals$ imply for an arbitrary bath correlation function
\begin{equation}
  \frac{\delta \psi_t}{\delta \ZZ_t} = L \psi_t \quad (t > 0).
  \label{eq:nmqsd.dpsit_dzt}
\end{equation}
Since we assumed $\alpha(t-s)$ to be heavily sharply peaked around $s = t$ this is the only contribution of the functional derivative.
Using the convention $\int_0^t \delta(t-s) \dd s = \frac{1}{2}$ \autoref{eq:nmqsd.nmsse} then reads
\begin{equation*}
  \partial_t \psi_t(\ZZ) = -\ii \Hsys \psi_t(\ZZ) + L\ZZ_t\psi_t(\ZZ) - \frac{1}{2}\adj{L}L\psi_t(\ZZ),
\end{equation*}
where the driving process is a complex White Noise with $\E{Z_t \ZZ_s} = \delta(t-s)$.
In a formally exact manner the equation above should be written as
\begin{equation}
  \dd\psi_t = (-\ii\Hsys\psi_t - \frac{1}{2} \adj{L}L \psi_t) \dd t + L\psi_t \dd \cc\xi_t
  \label{eq:nmqsd.ito}
\end{equation}
with a complex Brownian motion $\xi_t$.
In order to define the solution $\psi_t$ uniquely we need to specify an appropriate interpretation of the stochastic differential equation \cite[p.~36]{Ok03_sde}:
We imagine the Brownian motion as a limit of stochastic processes $\xi^{(n)}_t \to \xi_t$, which are continuously differentiable with respect to time, then \autoref{eq:nmqsd.ito} transforms into a deterministic differential equation.
The limit of corresponding solutions $\psi^{(n)}_t$ coincides with $\psi_t$ only if we understand \autoref{eq:nmqsd.ito} it the Stratonovich sense.
However, in our case the It\=o- and the Stratonovich form agree since $\E Z_t Z_s = 0$ \cite[???]{GaCr85_handbook}.

% TODO Strange!
The Belavkin or simply stochastic Schrödinger equation~\ref{eq:nmqsd.ito} is a well known result in continuous measurement theory or quantum optics, where it appears as an unravelling of the Linblad master equation \cite{BaGr09_trajectories,???}.
Nevertheless our main ingredient in its derivation, namely the singular bath correlation function $\alpha(t) = \delta(t)$, shows how unphysical the Markov assumption is:
As $\alpha$ is given by the Fourier transform of the spectral density $J$,
% TODO Complete!
% negative frequencies, no problem here; timescales

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Convolutionless Formulation}
\label{sub:nmqsd.lin_nmsse.convolutionless}
% * on the existence
% * why it solves problems, true stochastic equation
% * dynamics
% * application
% TODO Functional taylor series?
% TODO "Proof" for O-Operator substitution?

As a cure for the last point Diósi, Gisin and Strunz \cite{DiGiSt98_nmqsd} proposed the powerful $O$-Operator substitution:
It is based on the additional assumption, that one can replace the functional derivative by a system operator $O$, which may only depend on the realisation of $\ZZ$ itself
\begin{equation}
  \frac{\delta \psi_t(\ZZ)}{\delta \ZZ_s} = O(t, s, \ZZ) \psi_t(\ZZ).
  \label{eq:nmqsd.o_substition}
\end{equation}
Besides getting rid of the derivative we use this substitution to derive a convolutionless form of \autoref{eq:nmqsd.nmsee} by rewritting it as
\begin{equation}
  \partial_t \psi_t = -\ii\Hsys\psi_t(\ZZ)  +  L\ZZ_t\psi_t(\ZZ)  -  \adj{L} \bar O(t, \ZZ) \psi_t(\ZZ)
  \label{eq:nmqsd.nmsse_o}
\end{equation}
with the time-local operator
\begin{equation}
  \bar O(t, \ZZ) := \int_0^t \alpha(t - s) O(t, s, \ZZ) \dd s.
  \label{eq:nmqsd.o_bar}
\end{equation}
Finally \autoref{eq:nmqsd.nmsse_o} is a genuine stochastic differential equation for the trajectory $\psi_t(\ZZ)$, but in the much smaller Hilbert space of the system.
This makes it exceptionally well suited for dealing with infinite sized environments numerically, provided the $\bar O$ is known.
%TODO replace good
Depending on the validity of the $O$-substitution the corresponding NMSSE~\ref{eq:nmqsd.nmsse_o} might be just as good as the original microscopic equation of motion~\ref{eq:???}.

% TODO Really?
For a few simple models---one is presented in \autoref{sec:nmqsd.twolevel}---an exact analytic expression for $O$ is known.
In these cases one proocedes as follows \cite{DiGiSt98_nmqsd}:
From the consistency condition
\begin{equation}
  \partial_t \frac{\delta \psi_t(\ZZ)}{\delta \ZZ_s} = \frac{\delta}{\delta \ZZ_s} \partial_t \psi_t(\ZZ)
  \label{eq:nmqsd.consistency_condition}
\end{equation}
and the initial condition familiar from \autoref{sec:nmqsd.markov}
\begin{equation}
  O(s, s, \ZZ) = L
  \label{eq:nmqsd.o_initial}
\end{equation}
we can derive an equation of motion for $O(t, s, \ZZ)$.
It still contains the functional derivative, but with an appropriate ansatz for the $\ZZ$-dependence of $O$, this is transformed into a system of coupled equations independent of the noise.
Nevertheless most treatments rely on approximation schemes, for example perturbation expansion for a small coupling parameter or nearly-Markovian environments \cite{YuDiGiSt99_pertubation}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Master Equation}
\label{sub:nmqsd.lin_nmsse.master}
%TODO Change title
%TODO More references to prior work?
% * existence of master equation
% * relation to lindblad

In the last section we introduced the convolutionless formulation primarily to simplify the treatment of the non-Markovian stochastic Schrödinger equation~\ref{eq:nmqsd.nmsse}.
Now we use it to show the connection of our approach to the master equations commonly used in the theory of open quantum systems.
% TODO WHY?
The latter is formulated in terms of the reduced density operator, which is recovered from the trajectories $\psi_t(\ZZ)$ by averaging over the pure states projectors $P_t = \ket{\psi_t(\ZZ)}\bra{\psi_t(\ZZ)}$.
In certain cases this can be done analytically in order to derive a master equation.

As a simple example we focus on models which yield a $\ZZ$ independent $\bar O$-operator, such as the Jaynes-Cummings model presented in \autoref{sec:nmqsd.twolevel}.
We follow the lines of Yu et al.~\cite{YuDiGiSt99_pertubation,YuDiGi00_master}, who also treat the general case by a systematic expansion of $O$ in the noise.
The equation of motion for $P_t$
\begin{equation}
  \partial_t P_t = -\ii [\Hsys, P_t] + \ZZ_t L P_t - \adj{L}\bar O(t)P_t + Z_t P_t \adj{L} - P_t \adj{\bar O(t)} L
  \label{eq:nmqsd.pt_eom}
\end{equation}
yields a closed evolution equation for $rho_t$ after averaging over the bath degrees of freedom only if we can restate the terms containing $\ZZ_t$ in noise-independent manner.
% TODO Why is it not possible to factorize? --> See habil
This can be done with the help of Novikov's formula \cite{No65_functionals}
\begin{equation*}
  \E[Z_t P_t] = \E[\intdd s \alpha(t - s) \frac{\delta}{\delta \ZZ_s} P_t].
\end{equation*}
% TODO Where?
A formal proof is provided in \autoref{sec:???} but the main idea is simple:
Under a Gaussian integral $\intdd^2 z \, \exp(-\abs{z}^2) \dots$ the multiplication by $z$ can be rewritten as a derivation $\partial_{\cc z}$.
By partial integration a similar result to the equation above is obtained.

The right hand side of Novikov's formula can be simplified further.
Since $\psi_t$ is holomorphic in $\ZZ$ we have
\begin{equation*}
  \frac{\delta}{\delta \ZZ_s} \bigg( \ket{\psi_t(\ZZ)}\bra{\psi_t(\ZZ)} \bigg) = \left( \frac{\delta}{\delta \ZZ_s} \ket{\psi_t(\ZZ)} \right)\bra{\psi_t(\zz)} = O(t, s) \ket{\psi_t(\ZZ)}\bra{\psi_t(\ZZ)}
\end{equation*}
with the $O$-operator substitution~\ref{eq:nmqsd.o_substition}.
Averaging over the equation of motion for the pure state projector~\ref{eq:nmqsd.pt_eom} finally gives the master equation for the reduced density matrix $\rho_t$
\begin{equation}
  \partial_t \rho_t = -\ii [\Hsys, \rho_t]  +  [L, \rho_t \adj{\bar O(t)}]  +  [\bar O(t) \rho_t, \adj{L}].
  \label{eq:nmqsd.master}
\end{equation}
This expression already resembles the well known Lindblad master equation~\ref{eq:???} for Markovian open quantum systems.
Indeed, in the Markovian limit $\alpha(t) = \frac{\gamma}{2}\delta(t)$ the $\bar O$-operator is given by $\bar O(t) = \frac{\gamma}{2} L$ as shown in \autoref{sec:nmqsd.markov}.
For some models the same holds true even for genuine non-Markovian environments except the coefficients may become time-dependent.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Nonlinear NMSSE}
\label{sec:nmqsd.nonlin_nmsse}
% * non-uniquesness of unravelling ==> used here to change weights
% * Motivation (Monte Carlo!, normalized states)
% * derivation
% * discussion
%
% TODO We are going back to the microscopical model!
% TODO Ask Strunz if non-analyticity of Φ needs to be mentioned explicitely
% TODO Mention Girsanov
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%TODO Remove either
In the last section we emphasize that the non-Markovian stochastic Schrödinger equation~\ref{eq:nmqsd.nmsse} can be interpreted either as a system-environment Schrödinger equation or as a stochastic differential equation for the trajectories $\psi_t(\ZZ)$.
% TODO Unravelling earlier?; This is the first time this equation is written down explicitely!!!
In the theory of Markovian systems the latter is often referred to as an unravelling of the corresponding master equation \cite{???}.
Either way in a numerical treatment the reduced density operator of the open system is determined by a Monte-Carlo evaluation of the partial trace (or stochastic average)
% TODO This has been defined earlier!!!
\begin{equation}
  \rho_t = \E[\ket{\psi_t}\bra{\psi_t}] = \int \ket{\psi_t(\zz)}\bra{\psi_t(\zz)} \mudz.
  \label{eq:nmqsd.reduced_matrix}
\end{equation}
The fineness of such a scheme is drastically reduced if there are few highly peaked contributions \cite{DuSh11_monte_carlo}.
% TODO Really?
As shown in a numerical investigation \cite{???} the NMSSE shows exactly this behavior: for most trajectories the norm $\braket{\psi_t(\ZZ)}{\psi_t(\ZZ)}$ goes to zero due to growing entanglement with the environment.
To recover the unitarity of the closed time evolution $\E[\braket{\psi_t}{\psi_t}] = \braket{\Psi_t}{\Psi_t} = 1$ the few trajectories with significant contribution have to be taken into consideration.
As we further elaborate in \autoref{sec:???} this requires an insurmountable sample size for certain system parameters.

% TODO This doesnt fit too well here
Seen purely as a stochastic tool to determine the reduced density operator the unravelling in \autoref{eq:nmqsd.reduced_matrix} is not unique:
we can perform any transformation under the integral which keeps its value fixed and obtain equally well relative states with a different measure.
As it improves the behavior of the Monte-Carlo evaluation noticeably we perform a change of measure such that the average can be taken over normalized states.
Such a procedure is well known from the theory of Markovian stochastic Schrödinger equation \cite{???} and results in a nonlinear equation of motion---the same is true for our non-Markovian approach.
% TODO Really?
Since the general case is treated later we focus on the convolutionless formulation of \autoref{eq:nmqsd.nmsse_o}.


Of course it is trivial to rewrite \autoref{eq:nmqsd.reduced_matrix} as an average over normalized states
\begin{equation*}
  \rho_t = \int \frac{\mathrm{d}^{2N} z}{\pi^N} \, \exp[-\abs{\zz}^2] \braket{\psitz}{\psitz} \, \frac{\ket{\psitz}\bra{\psitz}}{\braket{\psitz}{\psitz}},
\end{equation*}
now expressed with a time dependent density function.
To highlight the physical significance of the norm we notice that the latter is just the Q- or Husimi-function\footnote{We point out that the Husimi function is usually defined in terms of normalized coherent states. Hence the additional factor $\exp(-\abs{z}^2)$ for each oscillator in our notation.} of the bath given by \cite{Sc11_quantum_optics}
\begin{equation}
  Q_t(\zz, \cc\zz) = \frac{\exp[-\abs{\zz}^2]}{\pi^N}\, \bra{\zz} \Tr{sys} \big( \ket{\Psi_t}\bra{\Psi_t} \big)\ket{\zz}
                   = \frac{\exp[-\abs{\zz}^2]}{\pi^N}\, \braket{\psitz}{\psitz}.
  \label{eq:nmqsd.husimi}
\end{equation}
Expressed in terms of $Q_t$ the reduced density operator reads
\begin{equation}
  \rho_t = \int Q_t(\zz, \cc\zz) \, \frac{\ket{\psitz}\bra{\psitz}}{\braket{\psitz}{\psitz}} \mathrm{d}^{2N} z.
  \label{eq:nmqsd.rho_in_Q}
\end{equation}
% TODO IMPROVE!!!!
Due to being non-negative and normalized to unity $\int Q(\zz, \cc\zz) \dd z = 1$ the Husimi-function can be regarded as the (quasi)-probability distribution on phase space of the bath degrees of freedom:
Since a coherent state $\ket{z}$ resembles a wave packet localized around $z = (q + \ii \, p) / \sqrt{2}$, there is a well defined correspondence between coherent state labels $z$ and the canonical variables $(q, p)$.
% TODO This is just copied, rephrase!
Hence the norm of $\psitz$ simply determines the probability to find the bath oscillators in the coherent state $\ket{\zz}$.\\

We can now incorporate the dynamics of the environment in a comoving coherent state basis for our trajectories $\psitz$.
Making use of the microscopic Hamiltonian~\ref{eq:nmqsd.hamiltonian_microsopic} and the analyticity $\partial_{z_\lambda} \ket{\psitz}$ gives the time evolution of the Husimi-function
\begin{equation}
  \partial_t Q_z(\zz, \cc\zz) = - \sum_\lambda \partial_{\cc z_\lambda} \big( \ii g_\lambda \exp[-\ii \omega_\lambda t] \, \qmean{\adj L}_t \, Q_t(\zz, \cc\zz) \big) - \mathrm{c.c.}
  \label{eq:nmqsd.qdot}
\end{equation}
It is obvious that the equation of motion above contains the full back-reaction of the system due to the quantum average\footnote{We do not indicate its (non-holomorphic) dependence on $\cc\zz$ explicitly because our main goal is not the solution of \autoref{eq:nmqsd.eq:nmqsd.qdot}. Instead $Q_t$ is only used to derive normalized versions of our NMSSE-trajectories.}
\begin{equation*}
  \qmean{\adj L}_t = \frac{\bra{\psitz} \adj L \ket{\psitz}}{\braket{\psitz}{\psitz}}.
\end{equation*}
% TODO Check this
Remarkably \autoref{eq:nmqsd.qdot} can be solved with the method of characteristics since it has exactly the form of a (complex) Liouville equation.
The corresponding characteristic curves are are described by
\begin{equation}
  \cc{\dot z}_\lambda(t) = \ii g_\lambda \exp[-\ii \omega_\lambda t] \qmean{\adj L}_t.
  \label{eq:nmqsd.zdot}
\end{equation}
% TODO Phi holom/nonholom.?
We denote the corresponding flow by $\vec\phi_t$; hence by the usual abuse of notation $\cc z_\lambda(t) = \cc \phi_{\lambda,t}(\cc z_\lambda)$ with initial conditions $\cc z_\lambda(0) = \cc\phi_{\lambda, 0}(\cc z_\lambda) = \cc z_\lambda$.
\Autoref{eq:nmqsd.zdot} tells us that if the full state at time $t$ is $\ket{\psitz} \otimes \ket{\zz}$ and therefore the Husimi-function is localised around $\zz = (\vec q + \ii \, \vec p) / \sqrt{2}$ then the dominant contribution at $t + \Delta t$ comes from the coherent state $\ket{\zz + \dot\zz \Delta t}$.
For this reason we should use system states relative to $\ket{\zz(t)}$ instead in order to avoid vanishing contributions of single trajectories to $\rho_t$.

By construction the flow $\vec\phi_t$ also gives as a solution to \autoref{eq:nmqsd.qdot} for the Husimi-function
\begin{equation*}
  Q_t(\zz, \cc\zz) = \int Q_0(\zz_0, \cc\zz_0) \, \delta(\zz - \vec\phi_t(\zz_0)) \dd^{2N} z_0
\end{equation*}
where $\delta(\zz - \zz') = \prod_\lambda \delta(\Re(z_\lambda - z_\lambda')) \delta(\Im(z_\lambda - z_\lambda'))$.
% TODO Add reference
Since at the beginning our total state is given by the product $\ket{\Psi_t} = \ket{\psi_0} \otimes \ket{\zz}$ the initial condition for the Husimi-function reads $Q_0(\zz, \cc\zz) = \pi^{-N} \exp[-\abs{\zz}^2]$ as seen from \autoref{eq:nmqsd.husimi}.
With $\psi'_t = \psi_t \circ \vec\phi_t$ we can rewrite \autoref{eq:nmqsd.reduced_matrix} for the reduced density matrix as\footnote{Instead of directly introducing the normalized states $\tilde\psi_t$ as done by Strunz \cite{St01_habil} we explicitly define the interim state $\psi'_t$ to compare with the corresponding result for the hierarchy in \autoref{sub:num.sheom.nonlin}.}
\begin{equation}
  \rho_t = \int \frac{\mathrm{d}^{2N}z}{\pi^N} \, \exp[-\abs{\zz}^2] \, \frac{\ket\psitphi \bra\psitphi}{\braket{\psitphi}{\psitphi}}
         = \E[ \frac{\ket{\tilde\psi_t}\bra{\tilde\psi_t}}{\braket{\tilde\psi_t}{\tilde\psi_t}}].
  \label{eq:nmqsd.reduced_matrix_comoving}
\end{equation}
By its definition $\tilde\psi_t(\cc\zz)$ is just the relative state of $\ket{\Psi_t}$ belonging to the coherent state $\ket{\vec\phi_t(\cc\zz)}$.
Put differently these are exactly tho expansion coefficients of the full system-bath pure state in the comoving environmental basis.
It is quite remarkable that a closed equation of motion for the $\tilde\psi_t$ can be derived starting with
\begin{equation}
  \partial_t (\psi_t \circ \cc{\vec\phi}_t) = \partial_t\psi_t \circ \cc{\vec\phi}_t + \sum_\lambda (\partial_{\cc z_\lambda} \psi_t \circ \cc{\vec\phi}_t) \cdot (\partial_t \ccphitla).
  \label{eq:nmqsd.psiprime_dot}
\end{equation}
For the first term we can use the evolution equation~\ref{eq:nmqsd.nmsse_o} of the fixed-basis relative states $\psi_t$ with the $O$-operator substitution in place.
Replacing the coherent state labels by their comoving counterparts leads us to a shifted process:
The integral form of \autoref{eq:nmqsd.zdot}
\begin{equation}
  \ccphitla(\cc z_\lambda) = \cc z_\lambda + \ii g_\lambda \int_0^t \exp(-\ii \omega_\lambda s) \qmean{\adj L}_s \dd s
  \label{eq:nmqsd.comoving_flow}
\end{equation}
plugged into the microscopic version of the process~\ref{eq:nmqsd.stochastic_process} yields the shifted stochastic driving as
\begin{equation}
  \tildeZZ_t(\cc\zz) := \ZZ_t(\cc{\vec\phi}_t(\cc\zz)) = \ZZ_t(\cc\zz) + \int_0^t \cc{\alpha(t-s)} \qmean{\adj L}_s \dd s.
  \label{eq:stochastic_process_shiften}
\end{equation}
% TODO Mkay?
Since the $O$-operator substitution ensures that the equations of motion for $\psi_t$ are local with respect to $\ZZ$, the comoving dynamics just amount to replacing $\ZZ_t$ by $\tildeZZ_t$ in the first addend of~\ref{eq:nmqsd.psiprime_dot}.

% TODO Stress time independence of probabilty
The second addend, due to the intrinsic time dependence of the shifted coherent states, is treated on the same footing:
It is just the well-known functional derivative term from the NMSSE as \autoref{eq:nmqsd.zdot} reveals:
\begin{align*}
  \sum_\lambda \frac{\partial\ccphitla}{\partial t}(\cc z_\lambda) \cdot \frac{\partial\psi_t}{\partial \cc z_\lambda} (\cc{\vec\phi}_t(\cc\zz))
  &= \ii \sum_\lambda g_\lambda \exp[-\ii \omega_\lambda t] \qmean{\adj L}_t \, \frac{\partial\psi_t}{\partial \cc z_\lambda} (\cc{\vec\phi}_t(\cc\zz)) \\
  &= \qmean{\adj L}_t \, \int_0^t \alpha(t - s) \frac{\delta \psi_t}{\delta \ZZ_s} (\cc{\vec\phi}_t(\cc\zz)) \dd s \\
  &= \qmean{\adj L}_t \bar O(t, \tildeZZ) \tilde\psi_t(\tildeZZ),
\end{align*}
where the last line reflects the definition of the $\bar O$-operator in \autorefs{eq:nmqsd.o_substition} and~\ref{eq:nmqsd.o_bar}.
Both terms of~\ref{eq:nmqsd.psiprime_dot} combined yield the desired closed equation for $\tilde\psi_t$
\begin{equation}
  \partial_t \tilde\psi_t = -\ii\Hsys \tilde\psi_t + L\tildeZZ_t\tilde\psi_t - (\adj L - \qmean{\adj L}_t) \bar O(t, \tildeZZ) \tilde\psi_t.
  \label{eq:nmqsd.nmsse_nonlin}
\end{equation}
We want to recall that $\tilde\psi_t$ was introduced to allow averaging over normalized states in \autoref{eq:nmqsd.reduced_matrix_comoving}.
It does not imply $\tilde\psi_t(\tildeZZ)$ being normalized for all times, which would be favourable for interpreting the NMSSE as an stochastic equation for genuine pure system states.
It is quite remarkable that an extended version of \autoref{eq:nmqsd.nmsse_nonlin} exists that even preserves normalization of single realizations:
By considering the trajectories $\ket{\psi'_t} = \ket{\tilde\psi_t} / \sqrt{\braket{\tilde\psi_t}{\tilde\psi_t}}$ it is straightforward to derive the corresponding equation of motion \cite{???}
\begin{align}
  \partial_t\psi'_t &= -\ii\Hsys\psi'_t  +  \left(L - \qmean{L}_t\right) \tildeZZ_t\psi'_t  \nonumber \\
  &-  \left( (\adj{L} - \qmean{\adj L}_t) \bar O(t, \tildeZZ) - \qmean{(\adj{L} - \qmean{\adj L}_t) \bar O(t, \tildeZZ)} \right) \psi'_t
  \label{eq:nmqsd.nmsse_nonlin_full}
\end{align}
% TODO Copy to the paragraph above?
As mentioned in the motivation the nonlinear equations should be given precedence over the linear version when it comes to Monte-Carlo simulation.
They allow us to compute the density matrix as an average over realizations with same order of magnitude while restoring the reference measure (in the microscopic model) to the well known, time-independent Gaussian weight~\ref{eq:nmqsd.identity}.
Therefore generating realizations of the shifted processes $\tildeZZ_t$ is within the scope of general methods, as long as the expectation value $\qmean{\adj L}_s$ for all times $0 \le s \le t$ is known.
This is the only contribution to the nonlinear NMSSE which is explicitly time-nonlocal;
but since it involves only the average value there is no storage problem for numerical application.
% TODO OK?
Of course these comments neglect the question how to obtain the $\bar O$-operator, which contains all non-Markovian feedback of the environment.
For to application to any realistic physical system---except a few exactly solvable ones---this is actually the critical part in the implementation.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Interpretation of NMSSE}
\label{sec:nmqsd.interpretation}
% * Interpreatation of Markovian SSE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{NMSSE as Continous Measurement}
\label{sub:nmqsd.interpretation.measurement}
%TODO Change title
% * Kroenke/Continous Measurement

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Linear NMSSE as Schrödinger Equation}
\label{sub:nmqsd.interpretation.unitary_view}
% * Hilbert space of Noise processes
% * functional Tailor expansion
% * calculation rules

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{A Time-Nonlocal Picture}
\label{sub:nmqsd.interpretation.time_osci}
%TODO Change title
% * time oscillators
% * structure of interaction
% * make contact with Brownian motion picture
% * breakdown of interpretation for T ≠ 0


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Finite Temperature Theory}
\label{sec:nmqsd.temperature}
% * why necessary
% * why approach does not work anymore
%
% TODO quantum vs. classical noise
% TODO How it solves the negative frequency problem
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Until now we were only concerned with the temperature zero theory, which was defined by an initial product state with the environment in the vacuum state $\ket{\Psi_0} = \ket{\psi_0} \otimes \ket{\vec 0}$.
It translates into our NMSSE-framework as the demand of vanishing functional derivatives at the time $t = 0$
\begin{equation*}
  \frac{\delta \psi_0}{\delta \ZZ_s} = 0 \quad (s \in \Reals).
\end{equation*}
% TODO What about U_s→ t L U^*_s→ t
This allows us to restrict the integral domain for the derivatives in \autoref{eq:nmqsd.nmsse} and is therefore crucial for the $O$-operator substitution.
Without the upper limit $t$ for the integral the hierarchical equations of motion presented in \autoref{sec:num.sheom} fail as well.
In order to treat non-zero temperature systems with the non-Markovian stochastic Schrödinger equation we devise two methods that map to the vacuum initial conditions of the zero-temperature case.

To start off we assume a product initial state, but this time with a Gibbs state $\rho(\beta) = \frac{\exp[-\beta \Henv]}{Z}$ on the environment's side
\begin{equation}
  \rho_0 = \ket{\psi_0}\bra{\psi_0} \otimes \rho(\beta)
  \label{eq:nmqsd.initial_rho}
\end{equation}
with the bath partition function $Z = \Tr \exp[-\beta \Henv]$ at inverse temperature $\beta = 1/k_B T$.
This choice amounts to the following experimental setting:
At $t_\mathrm{init} \to -\infty$ the environment is brought into contact with an even larger heat bath at given temperature, while the coupling to the system is switched off.
% TODO What about the bath--superbath entanglement?
% TODO BAD GRAMMAR!
The environment is allowed to thermalize until $t=0$ when the super-bath is removed and the system-coupling is instantly tuned as given by \autoref{eq:nmqsd.Hint}.
% TODO Really? Elaborate!
The choice of a pure state projector for the system in \autoref{eq:nmqsd.initial_rho} is merely for convenience;
in contrast we cannot drop its product form.
% TODO Too complicated?
Therefore a initial thermal state of the system and bath with respect to $\Htot$ cannot be treated with the NMSSE due to entanglement.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Thermo Field Method}
\label{sub:nmqsd.temperature.thermofield}
% * method
%
% TODO Physical interpreatation of the thermal occupation number prefactors? Spontaneous and induced excitation/relaxation?
% TODO Purely real α --> classical thermal noise

Thermo field dynamics was introduced as a real-time approach to quantum fields at finite temperature \cite{???}.
It is favored over other methods in application to the NMSSE since it does not change the equation of motion~\cite{DiGiSt98_nmqsd} as shown below.
In the course of this section we follow the slightly more detailed accounts of Yu and Strunz \cite{Yu04_heat_bath,St01_habil}.

The main idea is to introduce a second fictitious bath of oscillators, which is independent from the physical environment and does not interact with the system.
Expressing its degrees of freedom in ladder operators $b_\lambda$ and $\adj{b}_\lambda$ gives us the new Hamiltonian in the Schrödinger picture
\begin{equation}
  \Htot = \Hsys \otimes \unit + \sum_\lambda (\cc{g}_\lambda L\otimes\adj{a}_\lambda + g_\lambda \adj{L}\otimes a_\lambda) + \unit \otimes \sum_\lambda \omega_\lambda (\adj{a}_\lambda a_\lambda - \adj{b}_\lambda b_\lambda).
  \label{eq:nmqsd.Htot_thermal}
\end{equation}
Although this Hamiltonian is not bounded from below due to negative frequencies of the fictitious oscillators, there are no stability problems since they do not interact with the physical degrees of freedom.
For the same reason the reduced dynamics obtained from \autoref{eq:nmqsd.Htot_thermal} are identical to the original microscopical model~\ref{eq:nmqsd.Htot}.
Therefore both yield equal reduced density matrices for our system provided we choose an initial state that reproduces \autoref{eq:nmqsd.initial_rho} upon tracing of the unphysical degrees of freedom.
% TODO Mhhh...
Since these are given by a product the choice of a total initial state is independent from the system and is equivalent to demand
\begin{equation}
  \Tr{b} \tilde\rho = \rho(\beta)
  \label{eq:nmqsd.rho_tilde}
\end{equation}
for the density matrix of both environments.
Here $\Tr{b}$ denotes the partial trace with respect to the fictitious degrees of freedom.

Remarkably a solution $\tilde\rho$ of \autoref{eq:nmqsd.rho_tilde} is given by the pure state projector on a vacuum state with respect to new annihilation operators $A$, $B$.
They are connected to the old ladder operators by a temperature dependent Bogoliubov transformation
\begin{align*}
  A_\lambda &= \sqrt{\bar n_\lambda + 1} \, a_\lambda + \sqrt{\bar n_\lambda} \, \adj{b}_\lambda \\
  B_\lambda &= \sqrt{\bar n_\lambda} \, \adj{a}_\lambda + \sqrt{\bar n_\lambda + 1} \, b_\lambda,
\end{align*}
with $\bar n_\lambda = \left( \exp(\beta \omega_\lambda) - 1 \right)^{-1}$ denoting the mean thermal occupation number of the (physical) oscillator mode $\lambda$.
% TODO Source! Sounds good?
An extensive but elementary calculation reveals that $\ket{0_{AB}}\bra{0_{AB}}$ with $\ket{0_{AB}} = \ket{0_A} \otimes \ket{0_B}$ defined by $A_\lambda\ket{0_{AB}} = B_\lambda\ket{0_{AB}} = 0$ satisfies \autoref{eq:nmqsd.rho_tilde}.

% TODO Sounds strange!
The doubling in degrees of freedom ensures that the reduced density matrix obtained from an initial pure state $\ket{\tilde\Psi_0} = \ket{\psi_0}\otimes\ket{0_{AB}}$ in the enlarged Hilbert space coincides with the original one lacking unphysical bath oscillators.
Expressed in these new coordinates the total Hamiltonian~\ref{eq:nmqsd.Htot_thermal} reads
\begin{align}
  \Htot = \Hsys\otimes\unit &+ \sum_\lambda \sqrt{\bar n_\lambda + 1} \, \left(\cc g_\lambda L\otimes\adj{A}_\lambda + g_\lambda \adj{L}\otimes A_\lambda \right) \nonumber \\
        \label{eq:nmqsd.Htot_thermal_shifted}
        &+ \sum_\lambda \sqrt{\bar n_\lambda} \, \left( g_\lambda \adj{L}\otimes\adj{B}_\lambda  + \cc g_\lambda L \otimes B_\lambda \right) \\
        &+ \unit \otimes \sum_\lambda \omega_\lambda \left( \adj{A}_\lambda A_\lambda - \adj{B}_\lambda B_\lambda \right). \nonumber
\end{align}
Our new Hamiltonian is identical to the zero-temperature model except for the system coupling to two separate oscillator baths instead of one;
therefore we need two independent processes $\ZZ_t$ and $\cc{W}_t$ for a stochastic version of \autoref{eq:nmqsd.Htot_thermal_shifted} in general:
\begin{align}
  \partial_t \psi_t = -\ii\Hsys\psi_t &+ L\ZZ_t\psi_t - \adj{L}\int_0^t \alpha_1(t-s) \frac{\delta \psi_t}{\delta \ZZ_s} \dd s \nonumber \\
  &+ \adj{L} \cc{W}_t \psi_t - L\int_0^t \alpha_2(t-s) \frac{\delta\psi_t}{\delta \cc{W}_s} \dd s.
  \label{eq:nmqsd.nmsse_thermal_2processes}
\end{align}
All effects of the original thermal initial state are now encoded in the correlation functions
\begin{equation*}
  \alpha_1(t) = \sum_\lambda (\bar n_\lambda + 1) \abs{g_\lambda}^2 \exp[-\ii\omega_\lambda t] \quad \mbox{and} \quad
  \alpha_2(t) = \sum_\lambda \bar n_\lambda \abs{g_\lambda}^2 \exp[\ii\omega_\lambda t]
\end{equation*}
for $\ZZ_t$ and $\cc{W}_t$ respectively.
Since both are Gaussian, their independence is equivalent to the vanishing of all their mutual correlations $\E[\ZZ_t W_s] = \E[Z_t W_s] = 0$.

% TODO FIX THE WHOLE PARAGRAPH FOR T=0 LIMITING CASE!
% * finite number of oscillators → no Bose Einstein condenstion, no problems!
As we doubled the bath degrees of freedom merely to cope with a thermal initial state it is quite natural that the zero-temperature result from \autoref{eq:nmqsd.nmsee} with a single driving process is recovered in the limit $T \to 0$\dots

The thermo field approach to our non-Markovian Schrödinger equation turns out to be especially simple in the case of self-adjoint coupling operators $\adj{L}$:
From \autoref{eq:nmqsd.nmsse_thermal_2processes} we see how both driving processes $\ZZ_t$ and $\cc{W}_t$ can be combined into a single one, which we will denote by $\ZZ_t$ again.
% TODO Too much since...
Since we took them to be mutually independent we find for our new sum process using $2\bar n_\lambda + 1 = \coth{\frac{\beta\omega_\lambda}{2}}$:
\begin{equation}
  \E[Z_t \ZZ_s] = \sum_\lambda \left(\abs{g_\lambda}^2 \, \coth{\frac{\beta \omega_\lambda}{2}} \, \cos{\omega_\lambda (t-s)} - \ii \sin{\omega_\lambda (t-s)} \right).
  \label{eq:nmqsd.combined_correlation}
\end{equation}

Consequently the finite temperature NMSSE takes the form identical to zero temperature theory.
They only differ in how the correlation function is obtained from a microscopical model or rather from a spectral density.
% TODO Too much?
It is not surprising that our combined correlation function~\ref{eq:nmqsd.combined_correlation} agrees with the result of Feynman and Vernon \cite{FeVe63_quantum_dissipative} derived in the path integral formalism for quantum Brownian motion.
But our approach is much more general since it can tackle any kind of open quantum system with linear coupling.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{unitary noise}
\label{sub:nmqsd.temperature.unitary}
% * method
% * would be better for hierarchies
% * still negative energies
% * problematic integral
% * classical noise --> alpha purely real

As shown in the last section we can treat classical thermal noise on the same footing as quantum noise under certain circumstances just by using a modified correlation function~\ref{eq:nmqsd.combined_correlation}.
It is worth noticing how the influence of thermal fluctuations modify only the real part of $\alpha$, a feature that explicitly distinguishes noisy classical perturbations \cite{FeHi10_path_integrals}.
Therefore it is quite instructive to present a different method for treating non-zero temperature within the non-Markovian quantum state diffusion.

We start off by expanding the thermal bath state in a coherent state basis \cite{WaMi08_quantum_optics}
\begin{equation*}
  \rho(\beta) = FILL IN
\end{equation*}
which is quite reminiscent of the expansion for a pure state projector that lead to our stochastic Schrödinger equation.
The corresponding pure initial states are a product involving all environmental oscillators
\begin{equation*}
  \ket{\Psi_0(\xi)} = \exp[-\frac{\abs{\vec\xi}^2}{2}] \ket{\psi_0} \bigotimes_\lambda \ket{\xi_\lambda}
\end{equation*}
where the additional prefactor is usually absorbed by using normalized coherent states.
A simple shift for the creation and annihilation operators $\adj{A}_\lambda = \adj{a}_\lambda - \cc{\xi}_\lambda$ and $A_\lambda = a_\lambda - \xi_\lambda$ respectively maps the environmental part of the initial state above onto the vacuum.
Therefore we can apply our zero-temperature derivation to the total Hamiltonian expressed in $A$ and $\adj{A}_\lambda$.
The resulting NMSSE reads
%TODO Fix apperance
\begin{equation}
  \partial_t \psi_t(\ZZ, \xi) = \left( -\ii\Hsys + L\cc\xi_t + \adj{L}\xi_t + L\ZZ_t - \adj{L}\int_0^t \alpha(t - s) \frac{\delta}{\delta \ZZ_s} \dd s \right) \psi_t(\ZZ, \xi, \cc\xi)
  \label{eq:nmqsd.nmsse_thermal_classic}
\end{equation}
with a classical driving process $\xi_t = \sum_\lambda g_\lambda \xi_\lambda \exp[-\ii \omega_\lambda t]$ and its familiar quantum counterpart $\ZZ_t$.
The former's properties are once again fixed by its correlations
\begin{equation*}
  \E\,\xi_t = 0, \quad \E\,\xi_t \xi_s =0, \quad\mbox{and}\quad \E\,\xi_t \cc{\xi}_s = 2\sum_\lambda \bar n_\lambda \abs{g_\lambda}^2 \cos{\omega_\lambda(t-s)}.
  \label{eq:nmqsd.process_properties}
\end{equation*}
% TODO Too much zero temperature...
Recovering the reduced density matrix not only requires an average over $\ZZ$ but also over all realizations of the thermal noise process $\xi_t$.
Since all thermal occupation numbers $\bar n_\lambda$ tend to zero for $T \to 0$, we obtain the zero temperature limit simply by setting $\xi_t = 0$.
This amounts to the trivial decomposition $\rho(T = 0) = \ket{\vec 0}\bra{\vec 0}$ of the zero temperature environmental state.
% TODO What is correlation? Why no functional derivative?
% TODO DISCUSSION!

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Dissipative Two-level System}
\label{sec:nmqsd.two_level}
% * analytic solution
% * existence of o-operator
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% TODO Introduction
\begin{equation}
  \partial_t \psi_t = -\ii\frac{\omega}{2}\sigma_z\psi_t + c \sigma_- \ZZ_t \psi_t - c\sigma_+ \int_0^t \alpha(t - s) \frac{\delta\psi_t}{\delta \ZZ_s} \dd s
  \label{eq:nmqsd.nmsse_twolevel}
\end{equation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{O-Operator Method}
\label{sub:nmqsd.two_level.o}
%
% TODO Check for complex c, if all terms are correct

As elaborated in \autoref{sub:nmqsd.lin_nmsse.convolutionless} we can simplify the NMSSE~\ref{eq:nmqsd.nmsse_twolevel} by replacing the functional derivative with an operator $O(t, s, \ZZ)$.
We try to solve the consistency condition~\ref{eq:nmqsd.consistency_condition} by a noise-independent ansatz
\begin{equation}
  O(t, s) = c f(t, s) \sigma_-,
  \label{eq:nmqsd.o_ansatz}
\end{equation}
hence all non-Markovian feedback from the environment is now encoded in the function $f(t, s)$ to be determined.
Plugging this ansatz into the evolution equation for $O$ yields
\begin{equation}
  \partial_t c f(t, s) \sigma_- = \left[-\ii \frac{\omega}{2} \sigma_z - c^2 F(t) \sigma_+\sigma_-, c f(t, s) \sigma_-\right]
  \label{eq:nmqsd.eom_for_o}
\end{equation}
with a shorthand notation $F(t) := \int_0^t \alpha(t-s) f(t, s) \dd s$.
From its definition~\ref{eq:nmqsd.o_bar} we see that $F$ is also the prefactor for the integrated operator $\bar O(t) = c F(t) \sigma_-$.
% TODO Sounds pretty much copied!
Since the operator algebra in \autoref{eq:nmqsd.eom_for_o} closes, our ansatz solves the equation of motion for $O$ provided $f$ evolves according to
% TODO Better way to write (s < t); indentation looks strange
\begin{equation*}
  \partial_t f(t, s) = \left(\ii \omega + c^2 F(t)\right) \, f(t, s) \quad (s \le t).
\end{equation*}
Appropriate initial conditions follow trivially from \autoref{eq:nmqsd.o_initial}; they read $f(s, s) = 1$.
In the special case of an exponential bath correlation function $\alpha(t) = g \exp[-\gamma\abs{t} - \ii\Omega t]$ we can also derive a differential equation that is closed in $F$
\begin{equation*}
  \partial_t F(t) = g + (\ii (\omega - \Omega) - \gamma) F(t) + c^2 F(t)^2.
\end{equation*}
Such correlation functions play a major role in the subsequent work.

As shown in \autoref{sub:nmqsd.lin_nmsse.master}, a convolutionless NMSEE with noise independent $O$-operator can be transformed into a master equation without any approximation.
For the model under consideration it turns out to closely resemble a Lindblad-type equation except for time-dependent coefficients
\begin{equation*}
  \partial_t \rho_t = -\ii \frac{\omega}{2} [\sigma_z, \rho_t] + c^2 [\sigma_-, \rho_t \sigma_+] + c^2 F(t) [\sigma_- \rho_t, \sigma_+].
  \label{eq:nmqsd.two_level_master}
\end{equation*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Noise-Expansion Method}
\label{sub:nmqsd.expansion}

In this section we propose a different method for solving \autoref{eq:nmqsd.nmsse_twolevel}:
% TODO Add reference
It is based on the expansion discussed in \autoref{???}, which allows us to express the quantum trajectories $\psitZ$ in a functional Taylor series with respect to the noise process.
Due to the particular coupling structure of the model we can neglect all terms higher than linear order in $\ZZ_t$.
As further elaborated in \autoref{sec:tla.general}, our NMSSE~\ref{eq:nmqsd.nmsse_twolevel} reduces to a $\Complex$-valued integro-differential equation
\begin{equation}
  \dot\psi^+(t) = -\ii \frac{\omega}{2} \psi^+(t) - c^2 \int_0^t \alpha(t - s) \exp[\ii \frac{\omega}{2} (t - s)] \psi^+(s) \dd s,
  \label{eq:nmqsd.dotpsi_plus}
\end{equation}
which is nevertheless quite involved---even from a numerical point of view.
% TODO Bad grammar
The situation is noticeably simpler for an exponential correlation function for which we calculate an analytic solution in the appendix as well.

But even without an explicit solution for $\psi^+(t)$ we may still discover some illuminating consequences concerning the $O$-operator from the last section.
With $\psi^-(t) = \psi^-(0) \, \exp(\ii \omega t / 2)$ the full quantum trajectory reads
\begin{equation}
  \psi_t(\ZZ) = \left(\begin{array}{c}
    \psi^+(t) \\ \psi^-(t)
    \end{array}\right)
  + c \int_0^t \left(\begin{array}{c}
    0 \\ \exp[\ii \frac{\omega}{2} (t-s)] \psi^+(s)
    \end{array}\right)
  \ZZ_s \dd s.
  \label{eq:nmqsd.solution}
\end{equation}
% TODO Good idea?
This allows us to calculate the functional derivative with respect to the driving process explicitly;
for $0 \le s \le t$ we find\footnote{For $s = t$ there is no additional prefactor $\frac{1}{2}$ from integrating a $\delta$-function localized at the upper integral boundary as explained in the footnote on page~\pageref{fn:tla.boundaries}.}
\begin{equation*}
  \frac{\delta \psi_t(\ZZ)}{\delta \ZZ_s} = c \left(\begin{array}{c}
    0 \\ \exp[\ii \frac{\omega}{2}(t - s)] \psi^+(s),
    \end{array}\right)
\end{equation*}
which agrees with out ansatz~\ref{eq:nmqsd.o_ansatz} in case we choose
\begin{equation}
  f(t, s) = \frac{\psi^+(s)}{\psi^+(t)} \, \exp[-\ii \frac{\omega}{2}(s - t)].
  \label{eq:nmqsd.o_ansatz_psi}
\end{equation}
A similar structure for the $O$-operator has been obtained by Strunz \cite{St01_habil} within a Heisenberg-operator method.
% TODO Discussion, different results, Pictures!
