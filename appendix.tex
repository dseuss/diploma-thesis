%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\chapter{Mathematical Preliminaries}
%\label{ch:math}
%
%In this chapter we substantiate the claim of \autoref{sub:nmqsd.interpretation.unitary_view}, that the linear non-Markovian Stochastic Schrödinger Equation
%\begin{equation}
%  \partial \psi_t = -\ii h \psi_t + L\ZZ_t \psi_t - \adj{L}\int_0^t \alpha(t-s) \frac{\delta\psi_t}{\delta\ZZ_s} \dd s
%  \label{eq:math.nmsse}
%\end{equation}
%can also be understood as a Schrödinger equation for the unitary time evolution of the system and the environment.
%Our investigation proceeds as follows:
%First we are concerned with the kinematic structure and provide an explicit construction of the underlying bath Hilbert space;
%subsequently we study how the noise process $\ZZ_t$ and the functional derivative in \autoref{eq:math.nmsse} can be realized as operators on this Hilbert space.
%
%Hereinafter we cannot attempt to present a mathematical rigorous treatment of the stochastic differential equation presented above.
%Instead our main goal is to provide a basic understanding how \autoref{eq:math.nmsse} fits into the established framework of Stochastic Analysis and more important how an interpretation in terms of ladder operators is justified.
%In our construction we closely follow the ideas of White Noise Analysis \cite{Hi80_brownian_motion,HiKuPoSt93_white_noise}.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\section{Hilbert Space of \quotes{Time Oscillators}}
%\label{sec:math.hilbert_space}
%%
%%TODO besser erklären, wie verschiede versionen zustande kommen
%%TODO reference
%%TODO ZZ_t explizit nochmal reinschreiben?
%%TODO Abkürzungen? NMSSE? BCF?
%%TODO interpretation von Ω?
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%Let us first recall some basic terminology from probability theory (see e.g.~\cite{Sc05_mims}):
%A $C$-valued \idef{random variable} $X$ is a measurable map from a measure space $(\Omega, \mathcal{A}, \PM)$ to the measurable space $(C, \mathcal{B})$.
%Here $\Omega$, $C$ denote sets, $\mathcal{A}$, $\mathcal{B}$ are $\sigma$-algebras of $\Omega$ and $C$ respectively, and $\PM$ is a probability measure on $(\Omega, \mathcal{A})$.\footnote{In what follows, we will consider only Borel-$\sigma$-algebras and therefore not mention them any further.}
%Expectation values, variances, etc., may then be expressed as integrals of $X$ with respect to $\PM$.
%
%%TODO Satz fertig
%It is important to mention, that --- versions\dots
%Therefore we may always use the version of $\ZZ_t$ defined in the microscopical model as
%\begin{equation*}
%  \ZZ_t(\zz) = -\ii \sum_{\lambda=1}^N \cc g_\lambda \cc z_\lambda \exp[\ii \omega_\lambda t]
%\end{equation*}
%with $\Omega=\Complex^N$ and $\PM=\exp[-\abs\zz^2]\dd^Nz$.
%But since this is---strictly speaking---valid only for a finite number $N$ of bath oscillators, we will take a different route:
%Using only the bath correlation function defined by
%\begin{equation}
%  \alpha(t) = \int_\Reals \exp[-\ii\omega t] \, J(\omega)\dd\omega
%  \label{eq:math.def_alpha}
%\end{equation}
%we establish a suitable measure space, which will be used to support our new environmental Hilbert space afterwards.
%Such a unified approach has the advantage of only making reference to the bath correlation function, stressing that it is the only property of the environment relevant within our model.
%Here $J(\omega)\dd\omega$ denotes the \idef{spectral density} formally represented by a positive, bounded measure, that is $J\ge0$ and $\int J(\omega)\dd\omega < \infty$.
%Although the latter condition excludes the important Markov limit $\alpha(t)\propto\delta(t)$ derived from a constant spectral density we can treat it along the same lines.
%
%%TODO Write down conventions for Fourier Transform.
%As a starting point we introduce the probability space $\Omega$ replacing the coherent state labels $(z_1, \dots, z_N)$.
%In what follows the \idef{Schwartz space} $\SchwartzS$ of real valued, infinitely often differtiable functions on $\Reals$ with rapid decrease plays an important role---see \cite[Chap.~7]{Ru91_functional_analysis} for its definition and properties.
%The reason for its importance is found in the following theorem.
%\begin{thm}[Minlos's Theorem, {{\cite[Thm.~1.1]{HiKuPo93_white_noise}}}]
%  \label{thm:math.minlos}
%  Let $\CHF$ be a characteristic functional on $\SchwartzS$, i.e. $\CHF\colon \SchwartzS \rightarrow \Reals$ with the properties
%  \begin{enumerate}[i)]
%    \item $\CHF$ is continous on $\mathcal{S}$,
%    \item $\CHF$ is positive definite,
%    \item $\CHF(0) = 1$.
%  \end{enumerate}
%  Then there exists a unique probability measure $\PM$ on $\dual{\SchwartzS}$ (the dual space of $\SchwartzS$), such that for all $f \in\SchwartzS$
%  \begin{equation}
%    \int_{\dual{\SchwartzS}} \exp[\ii \, \dualp{\xi}{f}] \dd\mu(\xi) = \CHF(f).
%    \label{eq:math.fourier_minlos}
%  \end{equation}
%\end{thm}
%
%Here $\dualp{\xi}{f}$ denotes the dual pairing of $\SchwartzS/\dual{\SchwartzS}$, which can formally be written as $\dualp{\xi}{f} = \int_\Reals \xi(t) f(t) \, \dd t$.
%We also recall that a function $f$ is called \idef{positive definite}, if\dots
%%TODO Insert definition POSTIVE DEFINITE
%In \cite{HiKuPo93_white_noise} they take advantage of this theorem to construct a real valued White Noise processes on $\dual\SchwartzS$ with the choice $\CHF(f) = \exp(-\int_\Reals f(t)^2 \dd t)$.
%This can be rephrased as $\CHF(f)=\exp(-\,\varf(f,f))$ with the \emph{variance functional} $\varf(f,f) =\int f(t)^2 \dd t$.\\
%
%But since we are interested in complex processes with memory we need to generalize these results in two directions.
%Notice how the variance functional from the last paragraph can be understood as Markov limit of the more general form
%\begin{equation}
%  \varf(f,f) = \int_{\Reals^2} \alpha(t-s) f(t) f(s) \dd t \dd s \quad (f \in\SchwartzS).
%  \label{eq:math.def_varfunc}
%\end{equation}
%
%
%
%%It turns out to be crucial for what follows that the variance functional always provides additional structure on our probability space.
%%\begin{lem}
%%  Let $\alpha$ be a correlation function, that is a Fourier transform of a bounded measure. Then
%%  \begin{equation}
%%    \varf(f, g) := \iint \alpha(t - s) \, f(t) \, g(s) \dd t \dd s \quad (f, g \in \SchwartzS)
%%    \label{eq:math.covf_sp}
%%  \end{equation}
%%  defines a real scalar product on $\SchwartzS$.
%%  Additionally $\varf$ is separately continuous in each component with respect to $\SchwartzS$.
%%  \label{lem:math.covf_sp}
%%\end{lem}
%%For the proof we need an important property of the Fourier transform when acted on test functions with rapid decrease.
%%% TODO Fix spaces!
%%% TODO Too much formula, more words!
%%\begin{lem}[{{\cite[Thm.~7.7]{Ru91_functional_analysis}}}]
%%  Let $\SchwartzSC=\SchwartzS+\ii\SchwartzS$ denote the complexified space of test-functions.
%%  Put differently $f \in \SchwartzSC \iff \Re{f}, \Im{f} \in \SchwartzS$.
%%  The Fourier transform is a continuous, linear one-to-one mapping of $\SchwartzSC$ onto $\SchwartzSC$.
%%  \label{lem:math.fourier}
%%\end{lem}
%%% TODO Does this look ok?
%%\begin{proof}[Proof of Lemma~\ref{lem:math.covf_sp}]
%%  Since $\abs{\alpha(t)} \le \int J(\omega)\dd\omega =: A < \infty$, we have for any $f,g\in\SchwartzS$
%%  \begin{equation*}
%%    \abs{\varf(f,g)} \le \iint \abs{\alpha(t-s) f(t) g(s)} \dd s \dd t
%%                     \le A \int\abs{f(t)}\dd t \, \int\abs{g(s)}\dd s
%%                     < \infty,
%%  \end{equation*}
%%  where we used that all test-functions are also integrable.
%%  Continuity also follows from this inequality, since convergence in the $\SchwartzS$-sense implies $L^1$-convergence.
%%
%%  Linearity and symmetry are trivial; therefore we only need to check that $\varf(f,f)=0$ implies $f=0$.
%%  Using Lemma~\ref{lem:math.fourier} we find a $\ift{f}\in\SchwartzSC$ with $\int\exp[-\ii\omega t]\ift{f}(\omega)\dd\omega = f(t)$.
%%  A short calculation then reveals
%%  \begin{align*}
%%    \varf(f,f) & = \iint \alpha(t-s) f(t) f(s) \dd t \dd s = \iint \alpha(t-s) \cc{f(t)} f(s) \dd t \dd s \\
%%               & = \iint  \int\exp[-\ii \Omega (t-s)]J(\Omega)\dd\Omega  \int\exp[\ii\omega t]\cc{\ift{f}(\omega)}\dd\omega  \int\exp[-\ii\omega' s]\ift{f}(\omega') \dd\omega'  \dd s \dd t \\
%%               & = \iiint \left(   \int \exp[-\ii(\Omega - \omega)t] \dd t  \int \exp[\ii(\Omega - \omega')s] \dd s  \right) \cc{\ift{f}(\omega)}\ift{f}(\omega') J(\Omega) \dd\Omega \dd\omega \dd\omega' \\
%%               & \propto \int \abs{\ift{f}(\Omega)}^2 J(\Omega) \dd\Omega.
%%  \end{align*}
%%  Therefore $\varf(f,f)=0$ implies $\ift{f}=0$, leading to the conclusion $f=0$.
%%\end{proof}
%%\begin{rem}
%%  For the Markovian regime the statement holds true as well, since $\varf$ coincides with the $L^2$-scalar product in that case.\\
%%\end{rem}
%
%However, we cannot apply \autoref{thm:math.minlos} directly to $\CHF(f)=\exp[-\, \varf(f,f)]$ because it does not apply to the complexified space $\SchwartzSC$.
%Instead we will follow the strategy in \cite{Hi80_brownian_motion}: first we restrict $\varf$ to $\SchwartzS$, where it does not necessarily have the form \eqref{eq:math.def_covf}.
%
%
%
%We want complex Hilbert space, Minlos only works with real. First define complex one, read of ``real'' sp, complexify again. Define $\alpha$ as FT, Define complex Pre-Hilbert space; define Complexification of $\SchwartzS$
%\begin{lem}
%  $\sp{\cdot}{\cdot}$ is well defined scalar product, continous on $\SchwartzS_\Complex$
%\end{lem}
%Complete $\SchwartzS_\Complex$; Hilbert Space $\mathcal{H}_\Complex$
%\begin{lem}
%  $\mathcal{H}_\Complex$ is seperable
%\end{lem}
%
%Go over to $\SchwartzS$, what is scalar product, use polarisation; show that complexified scalar product gives back old scalar product
%\begin{thm} \label{thm:mp_existence}
%  On $(\dual{\mathcal{S}_\Complex}, \mathcal{B})$ there exists a Gauss Measure $\mu$ such that for $f \in \SchwartzS_\Complex$
%  \begin{equation}
%    \label{eq:mp_fourier_gauss}
%    \int_{\dual{\SchwartzS_\Complex}} \exp{\left(\ii \, \Re(\xi, f)\right)} \dd\mu(\xi) = \exp(-\frac{1}{4} \Vert f \Vert_\mathcal{H})
%  \end{equation}
%\end{thm}
%
%Define $(L^2)$; scalar product; In the language of probability theory we have prop space $(\dual{\SchwartzS_\Complex}, \mathcal{B}, \mu)$. For $f,g \in \SchwartzS$ we have random variables $\cc{(\cdot, f)}$ and $(\cdot, g)$ such that $\E \ldots$. Can be continued to $\mathcal{H}$; later $Z_t := (\cdot, \delta_t)$; Formally
%  \begin{equation*}
%  (\xi, f) = \int \xi(t) f(t) \dd t = \int \int \xi(s) \delta(s-t) \dd s f(t) \dd t = \int (\cdot, \delta_t) f(t) \dd t
%  \end{equation*}
%Therefore $(\cdot, f) = \int Z_t f(t) \dd t$; Formal scalar product; Example Brownian motion,
%
%  \begin{thm} \label{thm:mp_expansion}
%  $(L^2)$ has the following ONB\dots
%  \end{thm}
%Symmetric Fock Space, how to recover microscopical model
%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\section{Noise Creation- and Anhilation Operators}
%\label{sec:math.operators}
%% * prove of Novikov Formula
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%On all elements with finite expansion, $f \in \mathcal{H}$ define $\op Z_f$; calculate Adjoint, Formal notation, define $\op Z_t$


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Analytic Solution of Dissipative Two-level System}
\label{ch:tla}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{General Solution}
\label{sec:tla.general}
%
% TODO Better title

Here we present in full detail the analytic solution of the dissipative two-level system introduced in \autoref{sec:nmqsd.two_level}.
The relevant NMSSE can always be written in terms of a single process
\begin{equation}
  \partial_t \psi_t = -\ii\frac{\omega}{2}\sigma_z\psi_t + c \sigma_- \ZZ_t \psi_t - c\sigma_+ \int \alpha(t - s) \frac{\delta\psi_t}{\delta \ZZ_s} \dd s.
  \label{eq:tla.nmsse_twolevel}
\end{equation}
As already mentioned we employ an ansatz for the quantum trajectory at most linear in $\ZZ_s$
\begin{equation}
  \psitZ = \psi(t) + \int_0^t \psi_s(t) \ZZ_s \dd s.
  \label{eq:tla.ansatz}
\end{equation}
% TODO Better footnote
Here we already incorporate that $\psitZ$ needs to be independent of $\ZZ_s$ for $s < 0$ and $s>t$ by using a bounded integral domain.\footnote{A consistent treatment of these independence-conditions is more tricky than it seems at first glance, since we are mixing a distributional object $\ZZ_s$ with a discontinuous function $s \mapsto \psi_s(t)$.
  As $\delta \psi_t(\ZZ) / \delta \ZZ_s = 0$ translates to $\psi_s(t) = 0$ the correct integral boundary reads $\int_{0-\varepsilon}^{t+\varepsilon}$ with $\varepsilon > 0$ but arbitrary otherwise.
  \label{fn:tla.boundaries}
}
We use a basis for $\psi_t(\ZZ)$ which renders $\sigma_z$ diagonal and denote the corresponding components by \quotes{+} and \quotes{-}.
The \quotes{+}-component of our NMSSE with the ansatz~\ref{eq:tla.ansatz} reads
\begin{align}
  \dot\psi^+(t) + \psi^+_t(t)\ZZ_t &+ \int_0^t \dot\psi^+_s\ZZ_s \dd s \nonumber\\
  &= -\ii \frac{\omega}{2} \left( \psi^+(t) + \int_0^t \psi^+_s(t)\ZZ_s \dd s \right) - c \int_0^t \alpha(t-s) \psi^-_s(t) \dd s.
  \label{eq:tla.psi_plus}
\end{align}
In order to separate contributions of different order in $\ZZ_s$, we apply the functional derivative $\delta/\delta\ZZ_s$ with arbitrary $s$ to the last equation
\begin{equation}
  \psi^+_t(t) \delta(t - s) + \int_0^t \dot\psi^+_{s'}(t) \delta(s - s') \dd s' = -\ii \frac{\omega}{2} \int_0^t \psi^+_{s'}(t) \delta(s - s') \dd s'.
  \label{eq:tla.psi_plus_deriv}
\end{equation}
Choosing $s \in (0, t)$ leaves us with a simple ordinary differential equation with solution $\psi^+_s(t) = C_s \exp[- \ii \omega t / 2]$.
By further investigating the singular term in \autoref{eq:tla.psi_plus_deriv} we find that $\psi^+_s(s)$ and therefore the constant $C_s$ must vanish.
This amounts formally to integrating~\ref{eq:tla.psi_plus_deriv} over a small interval $(t-\varepsilon, t+\varepsilon)$ with respect to $s$.
In the limit $\varepsilon \to 0$ all terms except the first go to zero.
On the other hand we can isolate all terms independent of $\ZZ_s$ in \autoref{eq:tla.psi_plus} simply by taking the expectation value.
The resulting equation
\begin{equation}
  \dot\psi^+(t) = -\ii \frac{\omega}{2} \psi^+(t)  - c \int_0^t \alpha(t - s) \psi^-_s(t) \dd s
  \label{eq:psi_plus_expect}
\end{equation}
is treated later, once we have an explicit expression for $\psi^-_s(t)$.

The \quotes{-} component of \autoref{eq:tla.nmsse_twolevel} is quite similar to~\ref{eq:tla.psi_plus}
\begin{align}
  \dot\psi^-(t) + \psi^-_t(t)\ZZ_t &+ \int_0^t \dot\psi^-_s(t)\ZZ_s \dd s \nonumber \\
  &= \ii \frac{\omega}{2} \left( \psi^-(t) + \int_0^t \psi^-_s(t)\ZZ_s \right) + c \psi^+(t)\ZZ_t,
  \label{eq:tla.psi_minus}
\end{align}
where we already used that $\psi^+_s(t) = 0$.
The solution
\begin{equation}
  \psi^-(t) = \psi^-(0) \, \exp[\ii \frac{\omega}{2} t]
\end{equation}
can be read off \autoref{eq:tla.psi_minus} directly by comparing all terms independent of $\ZZ_t$.
In the same manner as we derived \autoref{eq:tla.psi_plus_deriv} we can treat all terms proportional to $\ZZ_t$.
Again we find a solution of the form $\psi^-_s(t) = C_s \exp[\ii\omega t / 2]$; the only difference is an additional singular term due to the driving process in \autoref{eq:tla.nmsse_twolevel}.
It gives rise to the boundary condition $\psi^-_t(t) = c \psi^+(t)$.
Together with~\ref{eq:tla.psi_plus_expect} we obtain a closed equation for $\psi^+(t)$
\begin{equation}
  \dot\psi^+(t) = -\ii \frac{\omega}{2} \psi^+(t) - c^2 \int_0^t \alpha(t - s) \exp[\ii \frac{\omega}{2} (t - s)] \psi^+(s) \dd s.
  \label{eq:tla.psi_plus_eq}
\end{equation}
Hence we may replace the original NMSSE~\ref{eq:tla.nmsse_twolevel} by a $\Complex$-valued equation similar in structure.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Exponential Correlation Function}
\label{sec:tla.exp}

As \autoref{eq:tla.psi_plus_eq} still contains a memory integral there is no analytic solution in general.
The situation is noticeably simpler for a bath correlation of the form
\begin{equation}
  \alpha(t - s) = \sum_{j=1}^N g_j \, \exp[-\gamma_j \abs{t - s} - \ii \Omega_j (t - s)].
  \label{eq:tla.exp_alpha}
\end{equation}
Since $\psi^+$ only depends on values of $\alpha(t)$ for $t \ge 0$ we can assume $\gamma = 0$ without loss of generality.
Similar to our hierarchical equations of motion elaborated in \autoref{sec:num.sheom} we absorb the problematic terms into auxiliary functions
\begin{equation}
  \phi_j(t) := \int_0^t \alpha_j(t-s) \exp[\ii \frac{\omega}{2}(t-s)] \psi^+(s) \dd s.
  \label{eq:tla.auxiliary}
\end{equation}
This allows us to rewrite \autoref{eq:tla.psi_plus_eq} as a system of $(N+1)$ ordinary differential equations with constant coefficients
\begin{align*}
  \dot\psi^+(t) &= -\ii \frac{\omega}{2} \psi^+(t) - c^2 \sum_{j=1}^N \phi_j(t) \\
  \dot\phi_j(t) &= g_j \psi^+(t) + \ii \left( \frac{\omega}{2} - \Omega \right) \phi_j(t).
\end{align*}
and initial conditions $\phi_j(0) = 0$.
In the special case $N = 1$ the diagonalization can be carried out analytically.
With the shorthand notation $\tilde\Omega = \sqrt{(\omega - \Omega)^2 + 4c^2 g}$ the solution to \autoref{eq:tla.psi_plus_eq} reads
\begin{equation}
  \psi^+(t) = \frac{\psi^+(0)}{2\tilde\Omega} \left( (\omega - \Omega + \tilde\Omega) \, \exp[-\ii \frac{\Omega + \tilde\Omega}{2} t ]  -  (\omega - \Omega - \tilde\Omega) \, \exp[-\ii \frac{\Omega - \tilde\Omega}{2} t ] \right).
  \label{eq:tla.solution}
\end{equation}

%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Expansions of Hyperbolic Cotangens}
\label{cha:coth}
%
% * punktierte Umgebung = punctured

Before presenting the two expansion schemes for the hyperbolic cotangens function mentioned in \autoref{sec:num.expansion} we need to introduce a few ideas from complex analysis.
For more details and proofs we refer to the book of Rudin \cite{Ru87_analysis}.

% TODO Is this already enough citation?
First recall that a function $f$ with an isolated singularity $a\in\Complex$ can always be expanded in a Laurent series around $a$
\begin{equation}
  f(z) = \sum_{j=0}^\infty a_j (z - a)^j + \sum_{j=1}^\infty \frac{a_{-j}}{(z-a)^j} \qquad (0 < \abs{z-a} < \varepsilon).
  \label{eq:coth.laurent}
\end{equation}
% TODO Mention punctured environment
The first sum is called \idef{analytical part} while the second one is called \idef{principal part}.
Clearly if $a$ is a removable singularity, that is the principal part vanishes, we can continue $f$ to a function analytical for all $z$ with $\abs{z-a} < \varepsilon$.
A complex function $f$ is said to be \idef{meromorphic} in an open set $\Omega\subset\Complex$ if it is analytical on $\Omega$ except a set $A \subset\Omega$ of isolated points, which are poles for $f$.
%Roughly speaking meromorphic functions are analytical leaving out some isolated poles; this reading is further substantiated by the following theorem.
%\begin{thm}[Mittag-Leffler, {{\cite[13.10]{Ru87_analysis}}}]
%  Suppose $\Omega$ is an open set in the complex plane, $A \subset \Omega$ has no limit points in $\Omega$, and to each $a \in A$ there is a polynomial of finite order $P_a(z)$ in $1/(z-a)$, that is
%  \begin{equation*}
%    P_a(z) = \sum_{j=1}^{o(a)} \frac{c_{j,a}}{(z-a)^j}.
%  \end{equation*}
%  Then there exists a meromorphic function $f$ in $\Omega$, whose principle part at each $a \in A$ is $P_a$ and which has no further singularities in $\Omega$.
%  \label{thm:coth.mittag_leffler}
%\end{thm}
%Clearly the choice of such a $f$ is not unique as we can always add a function analytical in $\Omega$ to $f$.
%On the other hand this exhausts all possibilities: if $f$ and $f'$ both satisfy the conditions mentioned above then they have identical isolated singularities given by the elements of $A$.
%The same applies to their difference $g = f - f'$; but since all principle parts for $f$ and $f'$ at each $a \in A$ match, we can continue $g$ to an analytical function on $\Omega$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Matsubara Expansion}
\label{sec:coth.matsubara}

In \autoref{sec:num.expansion} we use the expansion of the hyperbolic cotangens in terms of Matsubara frequencies \cite{Ma00_many_particle}
\begin{equation}
  \omega_n = \frac{2\pi n}{\beta} \qquad (n \in \Integers).
  \label{eq:coth.matsubara_freq}
\end{equation}
It provides a sum over poles representation, namely
\begin{equation}
  % TODO Check
  \coth\left(\frac{\beta z}{2}\right) = \frac{2}{\beta} \sum_{n=-\infty}^\infty \frac{1}{\ii\omega_n - z},
  \label{eq:coth.matsubara_expansion}
\end{equation}
with singularities evenly distributed along the imaginary axis.

In order to proof \autoref{eq:coth.matsubara_expansion} notice that $\ii\omega_n$ are exactly the isolated singularities of $z \mapsto \coth(\beta z / 2)$.
Indeed, using the representation
\begin{equation}
  f(z) := \coth\left(\frac{\beta z}{2}\right) = \frac{1 + \exp[-\beta z]}{1 - \exp[-\beta z]}
  \label{eq:coth.representation}
\end{equation}
we see that the numerator as well as the denominator are analytical for all $z \in \Complex$, but the latter vanishes for $z = \ii \omega_n$.
% TODO Elaborate?
A short calculation reveals that these $z$ are simple poles with $\operatorname{Res}f(\ii\omega_n) = 2/\beta$.

Let us now define $g$ by the right hand side of \autoref{eq:coth.matsubara_expansion}; in order to enforce convergence of the infinite series, we need to take the symmetric limit
\begin{equation}
  g(z) = \frac{2}{\beta} \, \lim_{N\to\infty} \sum_{n=-N}^{N} \frac{1}{\ii\omega_n - z} = - \frac{2}{\beta} \, \left( \sum_{n=0}^\infty \frac{2z}{\omega_n^2 + z^2} + \frac{1}{z} \right)
  \label{eq:coth.series}
\end{equation}
where we used $\omega_{-n} = -\omega_n$ in the second step.
Since $\omega\propto n$ the infinite series for $g$ in \autoref{eq:coth.series} converges absolutely unless $z = \ii\omega_n$ and defines a meromorphic function with the same poles and principal parts as $f$.
This leads to the conclusion that $h := f - g$ can be continued to an analytical function on the entire complex plane.
We now show that $h$ is bounded on $\Complex$ and therefore a constant function by Liouville's Theorem.
% TODO Fill in!
Expanding both $f$ and $g$ in a Laurent series about 0 allows us to calculate $f() = g() = $ as % lies within the convergence disk of both series.
In conclusion we find $h = 0$, or put differently $f = g$---the Matsubara expansion~\ref{eq:coth.matsubara_expansion} is valid on the entire complex plane.

% TODO Boundness of h!!
%
% Idea: Show f and g are bounded for Re z --> infinty; enough since periodic
