%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\chapter{Mathematical Preliminaries}
%\label{ch:math}
%
%In this chapter we substantiate the claim of \autoref{sub:nmqsd.interpretation.unitary_view}, that the linear non-Markovian Stochastic Schrödinger Equation
%\begin{equation}
%  \partial \psi_t = -\ii h \psi_t + L\ZZ_t \psi_t - \adj{L}\int_0^t \alpha(t-s) \frac{\delta\psi_t}{\delta\ZZ_s} \dd s
%  \label{eq:math.nmsse}
%\end{equation}
%can also be understood as a Schrödinger equation for the unitary time evolution of the system and the environment.
%Our investigation proceeds as follows:
%First we are concerned with the kinematic structure and provide an explicit construction of the underlying bath Hilbert space;
%subsequently we study how the noise process $\ZZ_t$ and the functional derivative in \autoref{eq:math.nmsse} can be realized as operators on this Hilbert space.
%
%Hereinafter we cannot attempt to present a mathematical rigorous treatment of the stochastic differential equation presented above.
%Instead our main goal is to provide a basic understanding how \autoref{eq:math.nmsse} fits into the established framework of Stochastic Analysis and more important how an interpretation in terms of ladder operators is justified.
%In our construction we closely follow the ideas of White Noise Analysis \cite{Hi80_brownian_motion,HiKuPoSt93_white_noise}.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\section{Hilbert Space of \quotes{Time Oscillators}}
%\label{sec:math.hilbert_space}
%%
%%TODO besser erklären, wie verschiede versionen zustande kommen
%%TODO reference
%%TODO ZZ_t explizit nochmal reinschreiben?
%%TODO Abkürzungen? NMSSE? BCF?
%%TODO interpretation von Ω?
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%Let us first recall some basic terminology from probability theory (see e.g.~\cite{Sc05_mims}):
%A $C$-valued \idef{random variable} $X$ is a measurable map from a measure space $(\Omega, \mathcal{A}, \PM)$ to the measurable space $(C, \mathcal{B})$.
%Here $\Omega$, $C$ denote sets, $\mathcal{A}$, $\mathcal{B}$ are $\sigma$-algebras of $\Omega$ and $C$ respectively, and $\PM$ is a probability measure on $(\Omega, \mathcal{A})$.\footnote{In what follows, we will consider only Borel-$\sigma$-algebras and therefore not mention them any further.}
%Expectation values, variances, etc., may then be expressed as integrals of $X$ with respect to $\PM$.
%
%%TODO Satz fertig
%It is important to mention, that --- versions\dots
%Therefore we may always use the version of $\ZZ_t$ defined in the microscopical model as
%\begin{equation*}
%  \ZZ_t(\zz) = -\ii \sum_{\lambda=1}^N \cc g_\lambda \cc z_\lambda \exp[\ii \omega_\lambda t]
%\end{equation*}
%with $\Omega=\Complex^N$ and $\PM=\exp[-\abs\zz^2]\dd^Nz$.
%But since this is---strictly speaking---valid only for a finite number $N$ of bath oscillators, we will take a different route:
%Using only the bath correlation function defined by
%\begin{equation}
%  \alpha(t) = \int_\Reals \exp[-\ii\omega t] \, J(\omega)\dd\omega
%  \label{eq:math.def_alpha}
%\end{equation}
%we establish a suitable measure space, which will be used to support our new environmental Hilbert space afterwards.
%Such a unified approach has the advantage of only making reference to the bath correlation function, stressing that it is the only property of the environment relevant within our model.
%Here $J(\omega)\dd\omega$ denotes the \idef{spectral density} formally represented by a positive, bounded measure, that is $J\ge0$ and $\int J(\omega)\dd\omega < \infty$.
%Although the latter condition excludes the important Markov limit $\alpha(t)\propto\delta(t)$ derived from a constant spectral density we can treat it along the same lines.
%
%%TODO Write down conventions for Fourier Transform.
%As a starting point we introduce the probability space $\Omega$ replacing the coherent state labels $(z_1, \dots, z_N)$.
%In what follows the \idef{Schwartz space} $\SchwartzS$ of real valued, infinitely often differtiable functions on $\Reals$ with rapid decrease plays an important role---see \cite[Chap.~7]{Ru91_functional_analysis} for its definition and properties.
%The reason for its importance is found in the following theorem.
%\begin{thm}[Minlos's Theorem, {{\cite[Thm.~1.1]{HiKuPo93_white_noise}}}]
%  \label{thm:math.minlos}
%  Let $\CHF$ be a characteristic functional on $\SchwartzS$, i.e. $\CHF\colon \SchwartzS \rightarrow \Reals$ with the properties
%  \begin{enumerate}[i)]
%    \item $\CHF$ is continous on $\mathcal{S}$,
%    \item $\CHF$ is positive definite,
%    \item $\CHF(0) = 1$.
%  \end{enumerate}
%  Then there exists a unique probability measure $\PM$ on $\dual{\SchwartzS}$ (the dual space of $\SchwartzS$), such that for all $f \in\SchwartzS$
%  \begin{equation}
%    \int_{\dual{\SchwartzS}} \exp[\ii \, \dualp{\xi}{f}] \dd\mu(\xi) = \CHF(f).
%    \label{eq:math.fourier_minlos}
%  \end{equation}
%\end{thm}
%
%Here $\dualp{\xi}{f}$ denotes the dual pairing of $\SchwartzS/\dual{\SchwartzS}$, which can formally be written as $\dualp{\xi}{f} = \int_\Reals \xi(t) f(t) \, \dd t$.
%We also recall that a function $f$ is called \idef{positive definite}, if\dots
%%TODO Insert definition POSTIVE DEFINITE
%In \cite{HiKuPo93_white_noise} they take advantage of this theorem to construct a real valued White Noise processes on $\dual\SchwartzS$ with the choice $\CHF(f) = \exp(-\int_\Reals f(t)^2 \dd t)$.
%This can be rephrased as $\CHF(f)=\exp(-\,\varf(f,f))$ with the \emph{variance functional} $\varf(f,f) =\int f(t)^2 \dd t$.\\
%
%But since we are interested in complex processes with memory we need to generalize these results in two directions.
%Notice how the variance functional from the last paragraph can be understood as Markov limit of the more general form
%\begin{equation}
%  \varf(f,f) = \int_{\Reals^2} \alpha(t-s) f(t) f(s) \dd t \dd s \quad (f \in\SchwartzS).
%  \label{eq:math.def_varfunc}
%\end{equation}
%
%
%
%%It turns out to be crucial for what follows that the variance functional always provides additional structure on our probability space.
%%\begin{lem}
%%  Let $\alpha$ be a correlation function, that is a Fourier transform of a bounded measure. Then
%%  \begin{equation}
%%    \varf(f, g) := \iint \alpha(t - s) \, f(t) \, g(s) \dd t \dd s \quad (f, g \in \SchwartzS)
%%    \label{eq:math.covf_sp}
%%  \end{equation}
%%  defines a real scalar product on $\SchwartzS$.
%%  Additionally $\varf$ is separately continuous in each component with respect to $\SchwartzS$.
%%  \label{lem:math.covf_sp}
%%\end{lem}
%%For the proof we need an important property of the Fourier transform when acted on test functions with rapid decrease.
%%% TODO Fix spaces!
%%% TODO Too much formula, more words!
%%\begin{lem}[{{\cite[Thm.~7.7]{Ru91_functional_analysis}}}]
%%  Let $\SchwartzSC=\SchwartzS+\ii\SchwartzS$ denote the complexified space of test-functions.
%%  Put differently $f \in \SchwartzSC \iff \Re{f}, \Im{f} \in \SchwartzS$.
%%  The Fourier transform is a continuous, linear one-to-one mapping of $\SchwartzSC$ onto $\SchwartzSC$.
%%  \label{lem:math.fourier}
%%\end{lem}
%%% TODO Does this look ok?
%%\begin{proof}[Proof of Lemma~\ref{lem:math.covf_sp}]
%%  Since $\abs{\alpha(t)} \le \int J(\omega)\dd\omega =: A < \infty$, we have for any $f,g\in\SchwartzS$
%%  \begin{equation*}
%%    \abs{\varf(f,g)} \le \iint \abs{\alpha(t-s) f(t) g(s)} \dd s \dd t
%%                     \le A \int\abs{f(t)}\dd t \, \int\abs{g(s)}\dd s
%%                     < \infty,
%%  \end{equation*}
%%  where we used that all test-functions are also integrable.
%%  Continuity also follows from this inequality, since convergence in the $\SchwartzS$-sense implies $L^1$-convergence.
%%
%%  Linearity and symmetry are trivial; therefore we only need to check that $\varf(f,f)=0$ implies $f=0$.
%%  Using Lemma~\ref{lem:math.fourier} we find a $\ift{f}\in\SchwartzSC$ with $\int\exp[-\ii\omega t]\ift{f}(\omega)\dd\omega = f(t)$.
%%  A short calculation then reveals
%%  \begin{align*}
%%    \varf(f,f) & = \iint \alpha(t-s) f(t) f(s) \dd t \dd s = \iint \alpha(t-s) \cc{f(t)} f(s) \dd t \dd s \\
%%               & = \iint  \int\exp[-\ii \Omega (t-s)]J(\Omega)\dd\Omega  \int\exp[\ii\omega t]\cc{\ift{f}(\omega)}\dd\omega  \int\exp[-\ii\omega' s]\ift{f}(\omega') \dd\omega'  \dd s \dd t \\
%%               & = \iiint \left(   \int \exp[-\ii(\Omega - \omega)t] \dd t  \int \exp[\ii(\Omega - \omega')s] \dd s  \right) \cc{\ift{f}(\omega)}\ift{f}(\omega') J(\Omega) \dd\Omega \dd\omega \dd\omega' \\
%%               & \propto \int \abs{\ift{f}(\Omega)}^2 J(\Omega) \dd\Omega.
%%  \end{align*}
%%  Therefore $\varf(f,f)=0$ implies $\ift{f}=0$, leading to the conclusion $f=0$.
%%\end{proof}
%%\begin{rem}
%%  For the Markovian regime the statement holds true as well, since $\varf$ coincides with the $L^2$-scalar product in that case.\\
%%\end{rem}
%
%However, we cannot apply \autoref{thm:math.minlos} directly to $\CHF(f)=\exp[-\, \varf(f,f)]$ because it does not apply to the complexified space $\SchwartzSC$.
%Instead we will follow the strategy in \cite{Hi80_brownian_motion}: first we restrict $\varf$ to $\SchwartzS$, where it does not necessarily have the form \eqref{eq:math.def_covf}.
%
%
%
%We want complex Hilbert space, Minlos only works with real. First define complex one, read of ``real'' sp, complexify again. Define $\alpha$ as FT, Define complex Pre-Hilbert space; define Complexification of $\SchwartzS$
%\begin{lem}
%  $\sp{\cdot}{\cdot}$ is well defined scalar product, continous on $\SchwartzS_\Complex$
%\end{lem}
%Complete $\SchwartzS_\Complex$; Hilbert Space $\mathcal{H}_\Complex$
%\begin{lem}
%  $\mathcal{H}_\Complex$ is seperable
%\end{lem}
%
%Go over to $\SchwartzS$, what is scalar product, use polarisation; show that complexified scalar product gives back old scalar product
%\begin{thm} \label{thm:mp_existence}
%  On $(\dual{\mathcal{S}_\Complex}, \mathcal{B})$ there exists a Gauss Measure $\mu$ such that for $f \in \SchwartzS_\Complex$
%  \begin{equation}
%    \label{eq:mp_fourier_gauss}
%    \int_{\dual{\SchwartzS_\Complex}} \exp{\left(\ii \, \Re(\xi, f)\right)} \dd\mu(\xi) = \exp(-\frac{1}{4} \Vert f \Vert_\mathcal{H})
%  \end{equation}
%\end{thm}
%
%Define $(L^2)$; scalar product; In the language of probability theory we have prop space $(\dual{\SchwartzS_\Complex}, \mathcal{B}, \mu)$. For $f,g \in \SchwartzS$ we have random variables $\cc{(\cdot, f)}$ and $(\cdot, g)$ such that $\E \ldots$. Can be continued to $\mathcal{H}$; later $Z_t := (\cdot, \delta_t)$; Formally
%  \begin{equation*}
%  (\xi, f) = \int \xi(t) f(t) \dd t = \int \int \xi(s) \delta(s-t) \dd s f(t) \dd t = \int (\cdot, \delta_t) f(t) \dd t
%  \end{equation*}
%Therefore $(\cdot, f) = \int Z_t f(t) \dd t$; Formal scalar product; Example Brownian motion,
%
%  \begin{thm} \label{thm:mp_expansion}
%  $(L^2)$ has the following ONB\dots
%  \end{thm}
%Symmetric Fock Space, how to recover microscopical model
%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\section{Noise Creation- and Anhilation Operators}
%\label{sec:math.operators}
%% * prove of Novikov Formula
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%On all elements with finite expansion, $f \in \mathcal{H}$ define $\op Z_f$; calculate Adjoint, Formal notation, define $\op Z_t$


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Analytic Solution of the Jaynes-Cummings Model}
\label{cha:tla}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{General Approach}
\label{sec:tla.general}

Here we present in full detail the analytic solution of the Jaynes-Cummings model introduced in \autoref{sec:nmqsd.two_level}.
For zero-temperature the relevant NMSSE can always be expressed in terms of a single process
\begin{equation}
  \partial_t \psi_t = -\ii\frac{\omega}{2}\sigma_z\psi_t + g \sigma_- \ZZ_t \psi_t - g\sigma_+ \int \alpha(t - s) \frac{\delta\psi_t}{\delta \ZZ_s} \dd s.
  \label{eq:tla.nmsse_twolevel}
\end{equation}
We make an ansatz for the quantum trajectory at most linear in $\ZZ_s$
\begin{equation}
  \psitZ = \psi(t) + \int_0^t \psi_s(t) \ZZ_s \dd s.
  \label{eq:tla.ansatz}
\end{equation}
% FIXME Is footnote clear?
Here we already incorporate the $\ZZ_s$-independence of $\psitZ$ for $s < 0$ and $s>t$ using a bounded integral domain.\footnote{%
  A consistent treatment of these independence-conditions is more tricky than it seems at first glance, since we are mixing a distributional object $\ZZ_s$ with a discontinuous function $s \mapsto \psi_s(t)$.
  As $\delta \psi_t(\ZZ) / \delta \ZZ_s = 0$ translates to $\psi_s(t) = 0$, the correct integral boundary reads $\int_{0-\varepsilon}^{t+\varepsilon}$ with $\varepsilon > 0$ but arbitrary otherwise.
  \label{fn:tla.boundaries}
}
% FIXME Is this really necessary?
%In where $\sigma_z$ is diagonal we denote corresponding components of $\psi_t$ by \quotes{+} and \quotes{-}.
The \quotes{+}-component of our NMSSE with the ansatz~\ref{eq:tla.ansatz} reads
\begin{align}
  \dot\psi^+(t) + \psi^+_t(t)\ZZ_t &+ \int_0^t \dot\psi^+_s\ZZ_s \dd s \nonumber\\
  &= -\ii \frac{\omega}{2} \left( \psi^+(t) + \int_0^t \psi^+_s(t)\ZZ_s \dd s \right) - g \int_0^t \alpha(t-s) \psi^-_s(t) \dd s.
  \label{eq:tla.psi_plus}
\end{align}
In order to separate contributions of different order in $\ZZ_s$, we apply the functional derivative $\delta/\delta\ZZ_s$ to the last equation
\begin{equation}
  \psi^+_t(t) \delta(t - s) + \int_0^t \dot\psi^+_{s'}(t) \delta(s - s') \dd s' = -\ii \frac{\omega}{2} \int_0^t \psi^+_{s'}(t) \delta(s - s') \dd s'.
  \label{eq:tla.psi_plus_deriv}
\end{equation}
Choosing $s \in (0, t)$ leaves us with a simple ordinary differential equation with solution $\psi^+_s(t) = C_s \exp(- \ii \omega t / 2)$.
Since there is only one singular term in \autoref{eq:tla.psi_plus_deriv}, $\psi^+_s(s)$ and thus the constant $C_s$ must vanish.
This amounts formally to integrating~\ref{eq:tla.psi_plus_deriv} over a small interval $(t-\varepsilon, t+\varepsilon)$ with respect to $s$.
In the limit $\varepsilon \to 0$ all terms except the first go to zero.

On the other hand we can isolate all terms independent of $\ZZ_s$ in \autoref{eq:tla.psi_plus} simply by taking the expectation value, yielding
\begin{equation}
  \dot\psi^+(t) = -\ii \frac{\omega}{2} \psi^+(t)  - g \int_0^t \alpha(t - s) \psi^-_s(t) \dd s.
  \label{eq:psi_plus_expect}
\end{equation}
We postpone its solution to the end of this section.\\



The \quotes{-} component of \autoref{eq:tla.nmsse_twolevel} is quite similar to~\ref{eq:tla.psi_plus}:
\begin{align}
  \dot\psi^-(t) + \psi^-_t(t)\ZZ_t &+ \int_0^t \dot\psi^-_s(t)\ZZ_s \dd s \nonumber \\
  &= \ii \frac{\omega}{2} \left( \psi^-(t) + \int_0^t \psi^-_s(t)\ZZ_s \right) + g \psi^+(t)\ZZ_t,
  \label{eq:tla.psi_minus}
\end{align}
where we already used that $\psi^+_s(t) = 0$.
All terms independent of $\ZZ$ require
\begin{equation}
  \psi^-(t) = \psi^-(0) \, \exp[\ii \frac{\omega}{2} t].
\end{equation}
In the same manner as we derived \autoref{eq:tla.psi_plus_deriv}, we can treat all terms proportional to $\ZZ_t$;
again we find a solution of the form $\psi^-_s(t) = C_s \exp(\ii\omega t / 2)$; the only difference is an additional singular term due to the driving process in \autoref{eq:tla.nmsse_twolevel}.
It gives rise to the boundary condition $\psi^-_t(t) = g \psi^+(t)$; therefore
Together with~\ref{eq:tla.psi_plus_expect} we obtain a closed equation for $\psi^+(t)$
\begin{equation}
  \dot\psi^+(t) = -\ii \frac{\omega}{2} \psi^+(t) - c^2 \int_0^t \alpha(t - s) \exp[\ii \frac{\omega}{2} (t - s)] \psi^+(s) \dd s.
  \label{eq:tla.psi_plus_eq}
\end{equation}
Hence we may replace the original NMSSE~\ref{eq:tla.nmsse_twolevel} by a $\Complex$-valued integro-differential equation.
The full solution to \autoref{eq:tla.nmsse_twolevel} in terms of $\psi^+(t)$ is written out in \autoref{eq:nmqsd.solution}.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Exponential Correlation Function}
\label{sec:tla.exp}

\Autoref{eq:tla.psi_plus_eq} still contains a memory integral, which appears to be impossible to solve analytically for an arbitrary bath correlation function.
The situation is noticeably simpler for
\begin{equation}
  \alpha(t - s) = \sum_{j=1}^N g_j \, \exp[-\gamma_j \abs{t - s} - \ii \Omega_j (t - s)].
  \label{eq:tla.exp_alpha}
\end{equation}
Since $\psi^+$ only depends on values of $\alpha(t)$ for $t \ge 0$ we can assume $\gamma = 0$ without loss of generality.
Similar to our hierarchical equations of motion we absorb the problematic terms into auxiliary functions
\begin{equation}
  \phi_j(t) := \int_0^t \alpha_j(t-s) \exp[\ii \frac{\omega}{2}(t-s)] \psi^+(s) \dd s,
  \label{eq:tla.auxiliary}
\end{equation}
this allows us to rewrite \autoref{eq:tla.psi_plus_eq} as a system of $(N+1)$ ordinary differential equations
\begin{align*}
  \dot\psi^+(t) &= -\ii \frac{\omega}{2} \psi^+(t) - g^2 \sum_{j=1}^N \phi_j(t) \\
  \dot\phi_j(t) &= g_j \psi^+(t) + \ii \left( \frac{\omega}{2} - \Omega \right) \phi_j(t).
\end{align*}
with constant coefficients and initial conditions $\psi^+(0)$ as well as $\phi_j(0) = 0$.
In the special case $N = 1$ the diagonalization of the coefficient matrix can be carried out analytically; for $N=2$ it is---at least in principle---possible, too.
With the shorthand notation $\tilde\Omega = \sqrt{(\omega - \Omega)^2 + 4g^2}$ and $g_1$ absorbed into the coupling strength $g$, the solution to \autoref{eq:tla.psi_plus_eq} reads
\begin{equation}
  \psi^+(t) = \frac{\psi^+(0)}{2\tilde\Omega} \left( (\omega - \Omega + \tilde\Omega) \, \exp[-\ii \frac{\Omega + \tilde\Omega}{2} t ]  -  (\omega - \Omega - \tilde\Omega) \, \exp[-\ii \frac{\Omega - \tilde\Omega}{2} t ] \right).
  \label{eq:tla.solution}
\end{equation}






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Some Remarks concerning the Hierachy}
\label{cha:hierarchy}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The Memory-Integral Term}
\label{sec:hierarchy.memory_integral}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In this section we discuss the crucial simplification, how an exponential bath correlation function $\alpha(t) = g\,\exp[-\gamma\abs{t}-\ii\Omega t]$ leads to
\begin{equation}
  \dot\adjZZ_t\psitZ = (-\gamma + \ii\Omega) \adjZZ_t\psitZ
  \label{eq:memint.adjzzt_deriv}
\end{equation}
for the noise-derivation operator $\adjZZ_t = \int\alpha(t-s)\delta/\delta \ZZ_s$ applied to a solution of the \NMSSE with vacuum initial conditions, that is $\frac{\delta\psi_0}{\delta \ZZ_s} = 0$.
 %= g \exp[-\ii \Omega t] \left( \Theta(t) \exp[-\gamma t] + \Theta(-t) \exp[\gamma t] \right),

For the above $\dot\adjZZ_t = \int\dot\alpha(t-s)\delta/\delta \ZZ_s$, we need to calculate
\begin{equation}
  \dot\alpha(t) = g \exp[-\ii \Omega t] \left( (-\gamma - \ii\Omega) \Theta(t) \exp[-\gamma t] + (\gamma - \ii\Omega)\Theta(-t)\exp[\gamma t] \right).
\end{equation}
Notice that the singular time-derivatives $\dot\Theta = \delta$ cancel.
This show clearly, that $\dot\adjZZ_t \propto \adjZZ_t$ does not hold on the level of operators.
Even the vanishing of the functional derivative $\delta \phi_t(\ZZ) / \delta \ZZ_s$ for $s > t$ with some arbitrary stochastic state $\phi_t(\ZZ)$ does not imply $\dot\adjZZ_t \phi_t(\ZZ) \propto \adjZZ_t\phi_t(\ZZ)$ as the following example shows:
Take a noise expansion of the form $\phi_t(\ZZ) = \varphi \cdot (\ZZ_t + \ZZ_{t'})$, where $\varphi$ is some $\ZZ_t$ independent system state and $0 < t' < t$.
It clearly satisfies the required boundary conditions, but
\begin{equation*}
  \dot\adjZZ_t \phi_t(\ZZ) = (\dot\alpha(0) + \dot\alpha(t-t')) \varphi = \left( -2\ii\Omega - (\gamma + \ii\Omega) \exp[-(\gamma + \ii\Omega) (t-t')] \right) \varphi
\end{equation*}
which is not proportional to
\begin{equation*}
  \adjZZ_t \phi_t(\ZZ) = (\alpha(0) + \alpha(t - t')) \varphi = g (1 + \exp(-\gamma + \ii \Omega)(t-t')) \varphi.
\end{equation*}
The problematic first summand arises due to singular behavior of $\delta \phi_t(\ZZ) / \delta \ZZ_s$ at the upper integral bound $s = t$.

However, such problems do not occur once we restrict $\dot\adjZZ_t$ to solutions of our NMSSE~\ref{eq:num.nmsse} with vacuum initial conditions.
Indeed, since $\delta\psit / \delta\ZZ_t \propto L\psit$, the functional derivative of $\psitZ$ at the upper bound is regular and therefore has vanishing weight under the integral.
This is how we obtain \autoref{eq:memint.adjzzt_deriv}.

% section memory_integral (end)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Terminating the Hierarchy}
\label{sec:hierarchy.terminator}

% TODO Some detailed discussion
% TODO Time-local/nonlocal terminators
\begin{equation}
  \psit[k] = \int_0^t \exp[-kw(t-s)] \Texp[\int_s^t -\ii\Hsys + L\ZZ_u \dd u] \left( k \alpha(0)L\psi_s^{(k-1)} - \adj{L} \psi_s^{(k+1)} \right) \dd s,
  \label{eq:num.terminator_integral}
\end{equation}

% too generic cases γ=0 and Ω=0; different approaches, ...
% when is k large enough
% truncation criterion: \sqrt(g) << k * |w|


% section hierarchy.terminator (end)



%\section{Matsubara Spectrum Decomposition}
%\label{sec:coth.matsubara}

%In section we proof the Matsubara expansion of the hyperbolic cotangens
%\begin{equation}
  %\coth z = \sum_{n=-\infty}^\infty \frac{1}{\ii\xi_n - z},
  %\label{eq:num.matsubara_expansion}
%\end{equation}
%with $\xi_n = \pi n$ using elementary tools from Complex Analysis, see the book of Rudin \cite{Ru87_analysis} for more details.
%Recall that a function $f$ with an isolated singularity $a\in\Complex$ can always be expanded in a Laurent series around $a$
%\begin{equation}
  %f(z) = \sum_{j=0}^\infty a_j (z - a)^j + \sum_{j=1}^\infty \frac{a_{-j}}{(z-a)^j} \qquad (0 < \abs{z-a} < \varepsilon).
  %\label{eq:coth.laurent}
%\end{equation}
%The first sum is called \idef{analytical part} while the second one is called \idef{principal part}.
%Clearly, if $a$ is a removable singularity, that is the principal part vanishes, we can continue $f$ to an analytical function for all $z$ with $\abs{z-a} < \varepsilon$---this is the content of Riemann's theorem.
%A complex function $f$ is said to be \idef{meromorphic} on an open set $\Omega\subset\Complex$, if it is analytical on $\Omega$ except a set $A \subset\Omega$ of isolated points, which are finite poles for $f$.\\



%To prove \autoref{eq:num.matsubara_expansion}, notice that $\ii\xi_n$ are exactly the isolated singularities of the hyperbolic cotangens.
%Indeed, using the representation
%\begin{equation}
  %\coth z = \frac{1 + \exp[-2 z]}{1 - \exp[-2 z]}
  %\label{eq:coth.representation}
%\end{equation}
%we see that the numerator as well as the denominator are analytical for all $z \in \Complex$, but the latter vanishes for $z = \ii \xi_n$.
%By the usual formula for simple poles, we find for the corresponding residua
%\begin{equation*}
  %\Res_{\ii\pi n} (\coth) = \lim_{z\to \ii\pi n} z \coth z = 1
%\end{equation*}

%Let us now define $g$ by the right hand side of \autoref{eq:num.matsubara_expansion}; in order to enforce convergence of the infinite series, we need to take the symmetric limit
%\begin{equation}
  %g(z) = \lim_{N\to\infty} \sum_{n=-N}^{N} \frac{1}{\ii\xi_n - z} = - \sum_{n=0}^\infty \frac{2z}{\pi^2 n^2 + z^2} - \frac{1}{z}.
  %\label{eq:coth.series}
%\end{equation}
%Since there is $n^2$ in the denominator, the infinite series for $g$ converges absolutely unless $z = \pm \ii \pi n$ and defines a meromorphic function with the same poles and residues as the hyperbolic cotangens.
%This leads to the conclusion that $h := \coth - g$ can be continued to an analytical function on the entire complex plane.
%Except in the vicinity of their poles, $\coth$ and $g$ are bounded, therefore, $h$ is a bounded, entire function on $\Complex$.
%Finally, we know from Liouville's Theorem that $h$ is a constant function, which can be calculated from

%% FIXME FINALIZE


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Application to FMO}
\label{sec:coth.fmo}
%

In this section we present the details for the FMO-transfer in \autoref{sec:app.fmo}.
We start by calculating the exponential expansion
\begin{equation}
  \alpha(t) = \sum_{n=0}^\infty g_n\,\exp[-\gamma_n t]
  \label{eq:coth.alpha_expansion}
\end{equation}
of the bath correlation function for a Drude spectral density
\begin{equation*}
  J(\omega) = \frac{2 \lambda}{\pi} \frac{\gamma\omega}{\omega^2 + \gamma^2}
\end{equation*}
with poles $\omega = \pm \ii\gamma$ and residues $\Res_{\pm\ii\gamma} (J) = \frac{\gamma\lambda}{\pi}$.
Let us write $\alpha(t) = a(t) + \ii b(t)$ with the corresponding integrals
\begin{align*}
  a(t) = \frac{1}{2} \int J(\omega) \, \coth \left( \frac{\beta\omega}{2} \right) \, \exp[\ii\omega t] \dd\omega \qquad \mbox{and} \qquad
  b(t) = \frac{1}{2\ii} \int J(\omega) \, \exp[\ii\omega t] \dd\omega.
\end{align*}
As already mentioned in \autoref{sec:num.expansion}, these integrals are solved using the residue theorem:
For $t > 0$ we have to include only poles with positive imaginary part, so \autoref{eq:num.sum_over_poles} gives
\begin{align*}
  a(t) &= \ii \gamma\lambda\, \coth \left(\frac{\ii\beta\gamma}{2}\right) \exp[-\gamma t] + \frac{2\pi\ii}{\beta} \sum_{\gamma_n} \frac{2\lambda}{\pi} \frac{\ii\gamma\gamma_n}{-\gamma_n^2 + \gamma^2} \, \exp[-\gamma_n t] \\
  &= \gamma\lambda\, \cot \left(\frac{\beta\gamma}{2}\right) \exp[-\gamma t] + \frac{4\lambda\gamma}{\beta} \sum_{\gamma_n} \frac{\gamma_n}{\gamma_n^2 - \gamma^2} \, \exp[-\gamma_n t],
\end{align*}
where the last sum is taken over Matsubara frequencies $\gamma_n = 2\pi n / \beta$, $n \ge 1$.
For convenience we also set $\gamma_0 = \gamma$.

Similarly, we have for the imaginary part
\begin{equation*}
  b(t) = \gamma\lambda \, \exp[-\gamma t].
\end{equation*}
In conclusion, we obtain for the parameters in the expansion~\ref{eq:coth.alpha_expansion}
\begin{equation*}
  g_0 = \gamma\lambda \left(\cot \left( \frac{\beta \gamma}{2}\right) - \ii\right) \qquad \mbox{and} \qquad
  g_{n\ge1} = \frac{4\lambda\gamma}{\beta} \frac{\gamma_n}{\gamma_n^2 - \gamma^2}.
\end{equation*}\\

We now turn to the concrete values used in \autoref{sec:app.fmo} and the calculations of Ishizaki-Fleming \cite{IsFl09_fmo}; for the results see \autoref{tb:fmo.bcfs}.

Compared to the inverse relaxation time $\gamma_0 = 106\,\mathrm{cm^{-1}}$, the first Matsubara frequency $\gamma_1 = 1310\,\mathrm{cm^{-1}}$ at $T = 300\,\mathrm{K}$ is already quite large.
The opposite holds for the corresponding coupling strengths $g_0 = (14279 - 3716\ii)\,\mathrm{cm^{-2}}$ and $g_1 = 2381\,\mathrm{cm^{-2}}$, respectively.
Hence, we follow the reference and drop all low-temperature correction terms with $n \ge 1$ in \autoref{eq:coth.alpha_expansion}.

For cryogenic temperature $T = 77\,\mathrm{K}$, a single mode with $g_0 = (2916 - 3716\ii)\,\mathrm{cm^{-2}}$ is not sufficient, since the first low-temperature correction term is given by $\gamma_1 = 336\,\mathrm{cm^{-2}}$ and $g_1 = 2628\,\mathrm{cm^{-2}}$.
However, the latter was approximated by a purely Markovian mode $\gamma_1\,\exp[-\gamma_1 t] \approx \delta(t)$ by Ishizaki-Fleming in order to keep the number of modes as small as possible for the \HEOM-approach.
The implementation of the pure-state hierarchies could not handle a true Markovian mode, so we resort to an exponential mode with $\tilde\gamma_1 > 1000\,\mathrm{cm^{-1}}$ in order to obtain good agreement.
To check whether such an approximation has a large impact on the results, we also check the true values in \autoref{fig:app.fmo_77_true}

\begin{table}[h]
  \centering
  % FIXME Letzte spalte rausnehmen, wenn nicht gebraucht
  \begin{tabu}{c|r|r|r}
    \rowfont[c]{}           & \autoref{fig:app.fmo_ishfl} & \autoref{fig:app.fmo_mevsphi} & \autoref{fig:app.fmo_77_true}  \\ \hline
    $g_0\,[\ucm^{-2}]$      & $2916 - 3716\ii$            & $14279 - 3716\ii$             & $2916 - 3716\ii$             \\
    $\gamma_0\,[\ucm^{-1}]$ & $106$                       & $106$                         & $106$                        \\ \hline
    $g_1\,[\ucm^{-2}]$      & $7814^*$                    & --                            & $2628$                       \\
    $\gamma_1\,[\ucm^{-1}]$ & $1000^*$                    & --                            & $336$                        \\ \hline
    $g_2\,[\ucm^{-2}]$      & $3716\ii$                   & $3716\ii$                     & $3716\ii$                    \\
    $\gamma_2\,[\ucm^{-1}]$ & $1000$                      & $1000$                        & $1000$                       \\ \hline\hline

  \end{tabu}
  \caption{%
    Parameters for the bath correlation function $\alpha(t) = \sum_n g_n\,\exp[-\gamma_n t]$ used in \autoref{sec:app.fmo}.
    Values marked with a star are approximated Markov-modes from the reference.
    The third mode is merely used to remove the imaginary part of $\alpha(0)$.
  }
  \label{tb:fmo.bcfs}
\end{table}

\begin{table}[h]
  \centering
  \begin{tabu}{c|rrrrrrr}
    \rowfont[c]{}
    $H_{mn}\, \mathrm{[cm^{-1}]}$ & 1            & 2            & 3            & 4            & 5            & 6            & 7  \\ \hline
    1                             & \textbf{410} & -87.7        & 5.5          & -5.9         & 6.7          & -13.7        & -9.9         \\
    2                             &              & \textbf{530} & 30.8         & 8.2          & 0.7          & 11.8         & 4.3          \\
    3                             &              &              & \textbf{210} & -53.5        & -2.2         & -9.6         & 6.0          \\
    4                             &              &              &              & \textbf{320} & -70.7        & -17.0        & -63.3        \\
    5                             &              &              &              &              & \textbf{480} & 81.1         & -1.3         \\
    6                             &              &              &              &              &              & \textbf{630} & 39.7         \\
    7                             &              &              &              &              &              &              & \textbf{440} \\
    \hline\hline
  \end{tabu}
  \caption{%
    Matrix elements of the purely electronic Hamiltonian used in \autoref{sec:app.fmo}.
    Consists of site energies (bold) and electronic coupling elements for \emph{Chlorobaculum tepidum} \cite{AdRe06_fmo}.
    An irrelevant global offset of $12\,000\,\mathrm{cm^{-1}}$ has been subtracted from the site energies.
  }
  \label{tb:fmo.hamiltonian}
\end{table}

% section coth.fmo (end)





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% SCRAP YARD  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%For more details and proofs we refer to the book of Rudin \cite{Ru87_analysis}.

%First recall that a function $f$ with an isolated singularity $a\in\Complex$ can always be expanded in a Laurent series around $a$
%\begin{equation}
  %f(z) = \sum_{j=0}^\infty a_j (z - a)^j + \sum_{j=1}^\infty \frac{a_{-j}}{(z-a)^j} \qquad (0 < \abs{z-a} < \varepsilon).
  %\label{eq:coth.laurent}
%\end{equation}
%The first sum is called \idef{analytical part} while the second one is called \idef{principal part}.
%Clearly if $a$ is a removable singularity, that is the principal part vanishes, we can continue $f$ to a function analytical for all $z$ with $\abs{z-a} < \varepsilon$.
%A complex function $f$ is said to be \idef{meromorphic} in an open set $\Omega\subset\Complex$ if it is analytical on $\Omega$ except a set $A \subset\Omega$ of isolated points, which are poles for $f$.
%Roughly speaking meromorphic functions are analytical leaving out some isolated poles; this reading is further substantiated by the following theorem.
%\begin{thm}[Mittag-Leffler, {{\cite[13.10]{Ru87_analysis}}}]
  %Suppose $\Omega$ is an open set in the complex plane, $A \subset \Omega$ has no limit points in $\Omega$, and to each $a \in A$ there is a polynomial of finite order $P_a(z)$ in $1/(z-a)$, that is
  %\begin{equation*}
    %P_a(z) = \sum_{j=1}^{o(a)} \frac{c_{j,a}}{(z-a)^j}.
  %\end{equation*}
  %Then there exists a meromorphic function $f$ in $\Omega$, whose principle part at each $a \in A$ is $P_a$ and which has no further singularities in $\Omega$.
  %\label{thm:coth.mittag_leffler}
%\end{thm}
%Clearly the choice of such a $f$ is not unique as we can always add a function analytical in $\Omega$ to $f$.
%On the other hand this exhausts all possibilities: if $f$ and $f'$ both satisfy the conditions mentioned above then they have identical isolated singularities given by the elements of $A$.
%The same applies to their difference $g = f - f'$; but since all principle parts for $f$ and $f'$ at each $a \in A$ match, we can continue $g$ to an analytical function on $\Omega$.
%In \autoref{sec:num.expansion} we use the expansion of the hyperbolic cotangens in terms of Matsubara frequencies \cite{Ma00_many_particle}
%\begin{equation}
  %\xi_n = \frac{2\pi n}{\beta} \qquad (n \in \Integers).
  %\label{eq:coth.matsubara_freq}
%\end{equation}
%It provides a sum over poles representation, namely
%\begin{equation}
  %\coth\left(\frac{\beta z}{2}\right) = \frac{2}{\beta} \sum_{n=-\infty}^\infty \frac{1}{\ii\xi_n - z},
  %\label{eq:coth.matsubara_expansion}
%\end{equation}
%with singularities evenly distributed along the imaginary axis.
